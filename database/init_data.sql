-- YCS LMS 테스트 데이터 초기화 스크립트
-- Supabase에서 실행할 SQL

-- 1. 기존 테스트 데이터 정리 (필요시)
-- DELETE FROM order_items WHERE order_id IN (SELECT id FROM orders WHERE order_number LIKE 'TEST-%');
-- DELETE FROM order_boxes WHERE order_id IN (SELECT id FROM orders WHERE order_number LIKE 'TEST-%');
-- DELETE FROM orders WHERE order_number LIKE 'TEST-%';
-- DELETE FROM user_profiles WHERE email LIKE '%@test.com';

-- 2. 테스트 사용자 계정 생성 (auth.users는 Supabase Auth로 관리되므로 user_profiles만 생성)
INSERT INTO user_profiles (
  id, username, name, email, phone, user_type, 
  approval_status, email_verified, terms_agreed, privacy_agreed,
  company_name, business_number, manager_name, manager_contact, address,
  created_at, updated_at
) VALUES
-- 일반회원
('00000000-0000-0000-0000-000000000001', 'general_user', '김일반', 'general@test.com', '010-1111-1111', 'general',
 'approved', true, true, true, null, null, null, null, '서울시 강남구 테헤란로 123',
 '2024-01-01 00:00:00+00', '2024-01-01 00:00:00+00'),

-- 기업회원  
('00000000-0000-0000-0000-000000000002', 'corporate_user', '이기업', 'corporate@test.com', '010-2222-2222', 'corporate',
 'approved', true, true, true, '테스트기업(주)', '123-45-67890', '김대리', '010-2222-3333', '서울시 서초구 강남대로 456',
 '2024-01-01 00:00:00+00', '2024-01-01 00:00:00+00'),

-- 파트너
('00000000-0000-0000-0000-000000000003', 'partner_user', '박파트너', 'partner@test.com', '010-3333-3333', 'partner',
 'approved', true, true, true, '파트너물류(주)', '234-56-78901', '박과장', '010-3333-4444', '서울시 마포구 월드컵로 789',
 '2024-01-01 00:00:00+00', '2024-01-01 00:00:00+00'),

-- 현장관리자
('00000000-0000-0000-0000-000000000004', 'warehouse_user', '최창고', 'warehouse@test.com', '010-4444-4444', 'warehouse',
 'approved', true, true, true, null, null, null, null, '인천시 중구 공항로 101 물류센터',
 '2024-01-01 00:00:00+00', '2024-01-01 00:00:00+00'),

-- 어드민
('00000000-0000-0000-0000-000000000005', 'admin_user', '관리자', 'admin@test.com', '010-5555-5555', 'admin',
 'approved', true, true, true, null, null, null, null, '서울시 중구 세종대로 110',
 '2024-01-01 00:00:00+00', '2024-01-01 00:00:00+00');

-- 3. 테스트 주문 데이터 생성
INSERT INTO orders (
  id, user_id, order_number, status, order_type, 
  recipient_name, recipient_phone, recipient_address,
  total_amount, requires_repack, requires_extra_recipient,
  shipping_notes, member_code, tracking_number,
  created_at, updated_at
) VALUES
-- 일반회원 주문들
('10000000-0000-0000-0000-000000000001', '00000000-0000-0000-0000-000000000001', 'TEST-GEN-001', 'pending', 'air',
 '김수취', '010-1234-5678', '태국 방콕 수쿰빗 로드 123', 
 150000, false, false, '조심히 다뤄주세요', 'GEN001', 'TH240815001',
 '2024-01-15 10:00:00+00', '2024-01-15 10:00:00+00'),

('10000000-0000-0000-0000-000000000002', '00000000-0000-0000-0000-000000000001', 'TEST-GEN-002', 'confirmed', 'sea',
 '이수취', '010-2345-6789', '태국 치앙마이 님만해민 로드 456',
 280000, true, false, '리패킹 요청', 'GEN001', 'TH240810002', 
 '2024-01-10 14:30:00+00', '2024-01-12 09:15:00+00'),

-- 기업회원 주문들  
('10000000-0000-0000-0000-000000000003', '00000000-0000-0000-0000-000000000002', 'TEST-COR-001', 'shipped', 'air',
 '박수취', '010-3456-7890', '태국 푸켓 파통 비치 로드 789',
 520000, false, true, '긴급 배송', 'COR001', 'TH240812003',
 '2024-01-12 16:45:00+00', '2024-01-13 11:20:00+00'),

('10000000-0000-0000-0000-000000000004', '00000000-0000-0000-0000-000000000002', 'TEST-COR-002', 'processing', 'sea',
 '최수취', '010-4567-8901', '태국 파타야 비치 로드 101',
 750000, true, true, '대량 주문', 'COR001', 'TH240813004',
 '2024-01-13 13:00:00+00', '2024-01-14 08:30:00+00'),

-- 파트너 추천 주문
('10000000-0000-0000-0000-000000000005', '00000000-0000-0000-0000-000000000001', 'TEST-REF-001', 'delivered', 'air',
 '정수취', '010-5678-9012', '태국 코사무이 차웽 비치 202',
 320000, false, false, '파트너 추천', 'REF001', 'TH240805005',
 '2024-01-05 11:15:00+00', '2024-01-08 16:45:00+00'),

-- 지연 주문 (회원코드 누락)
('10000000-0000-0000-0000-000000000006', '00000000-0000-0000-0000-000000000001', 'TEST-DEL-001', 'delayed', 'air',
 '한수취', '010-6789-0123', '태국 후아힌 비치 로드 303',
 95000, false, false, '회원코드 미기재로 지연', null, null,
 '2024-01-14 17:30:00+00', '2024-01-15 09:00:00+00');

-- 4. 주문 아이템 데이터
INSERT INTO order_items (
  id, order_id, name, description, quantity, unit_price, total_price,
  weight, ems_code, hs_code, created_at
) VALUES
-- TEST-GEN-001 아이템들
('20000000-0000-0000-0000-000000000001', '10000000-0000-0000-0000-000000000001', 
 '한국 김치', '매운맛 배추김치 500g', 2, 25000, 50000, 1.0, 'F001', '2005.99.1000',
 '2024-01-15 10:05:00+00'),

('20000000-0000-0000-0000-000000000002', '10000000-0000-0000-0000-000000000001',
 '한국 라면', '신라면 20개입', 5, 20000, 100000, 2.5, 'F002', '1902.30.0000',
 '2024-01-15 10:05:00+00'),

-- TEST-GEN-002 아이템들
('20000000-0000-0000-0000-000000000003', '10000000-0000-0000-0000-000000000002',
 '화장품 세트', '한국 화장품 기초 세트', 3, 80000, 240000, 1.8, 'C001', '3304.99.0000',
 '2024-01-10 14:35:00+00'),

('20000000-0000-0000-0000-000000000004', '10000000-0000-0000-0000-000000000002',
 '의류', '한국 전통 한복', 1, 40000, 40000, 0.8, 'T001', '6204.22.0000',
 '2024-01-10 14:35:00+00'),

-- TEST-COR-001 아이템들 (기업 대량 주문)
('20000000-0000-0000-0000-000000000005', '10000000-0000-0000-0000-000000000003',
 '전자제품', '스마트폰 케이스', 50, 8000, 400000, 5.0, 'E001', '3926.90.9800',
 '2024-01-12 16:50:00+00'),

('20000000-0000-0000-0000-000000000006', '10000000-0000-0000-0000-000000000003',
 '액세서리', '이어폰', 20, 6000, 120000, 2.0, 'E002', '8518.30.0000',
 '2024-01-12 16:50:00+00'),

-- TEST-COR-002 아이템들
('20000000-0000-0000-0000-000000000007', '10000000-0000-0000-0000-000000000004',
 '산업용품', '기계 부품', 10, 75000, 750000, 25.0, 'M001', '8483.10.9000',
 '2024-01-13 13:05:00+00'),

-- TEST-REF-001 아이템들
('20000000-0000-0000-0000-000000000008', '10000000-0000-0000-0000-000000000005',
 '건강식품', '홍삼 제품', 8, 40000, 320000, 3.2, 'H001', '1302.30.0000',
 '2024-01-05 11:20:00+00'),

-- TEST-DEL-001 아이템들
('20000000-0000-0000-0000-000000000009', '10000000-0000-0000-0000-000000000006',
 '서적', '한국어 교재', 3, 30000, 90000, 1.5, 'B001', '4901.99.0000',
 '2024-01-14 17:35:00+00'),

('20000000-0000-0000-0000-000000000010', '10000000-0000-0000-0000-000000000006',
 '문구류', '한국 전통 붓', 1, 5000, 5000, 0.2, 'S001', '9608.10.0000',
 '2024-01-14 17:35:00+00');

-- 5. 주문 박스 데이터
INSERT INTO order_boxes (
  id, order_id, box_number, width, height, depth, weight, cbm_m3,
  label_code, status, created_at
) VALUES
-- TEST-GEN-001 박스들
('30000000-0000-0000-0000-000000000001', '10000000-0000-0000-0000-000000000001', 
 1, 30, 25, 20, 3.5, 0.015, 'YCS240815001-01', 'received',
 '2024-01-15 10:10:00+00'),

-- TEST-GEN-002 박스들
('30000000-0000-0000-0000-000000000002', '10000000-0000-0000-0000-000000000002',
 1, 40, 35, 30, 4.2, 0.042, 'YCS240810002-01', 'processed',
 '2024-01-10 14:40:00+00'),

('30000000-0000-0000-0000-000000000003', '10000000-0000-0000-0000-000000000002',
 2, 25, 20, 15, 1.8, 0.0075, 'YCS240810002-02', 'processed',
 '2024-01-10 14:40:00+00'),

-- TEST-COR-001 박스들 (기업 대량)
('30000000-0000-0000-0000-000000000004', '10000000-0000-0000-0000-000000000003',
 1, 50, 40, 35, 7.0, 0.07, 'YCS240812003-01', 'shipped',
 '2024-01-12 17:00:00+00'),

('30000000-0000-0000-0000-000000000005', '10000000-0000-0000-0000-000000000003',
 2, 45, 35, 30, 5.5, 0.04725, 'YCS240812003-02', 'shipped',
 '2024-01-12 17:00:00+00'),

-- TEST-COR-002 박스들
('30000000-0000-0000-0000-000000000006', '10000000-0000-0000-0000-000000000004',
 1, 60, 50, 40, 25.0, 0.12, 'YCS240813004-01', 'processing',
 '2024-01-13 13:10:00+00'),

-- TEST-REF-001 박스
('30000000-0000-0000-0000-000000000007', '10000000-0000-0000-0000-000000000005',
 1, 35, 30, 25, 3.2, 0.02625, 'YCS240805005-01', 'delivered',
 '2024-01-05 11:25:00+00'),

-- TEST-DEL-001 박스들
('30000000-0000-0000-0000-000000000008', '10000000-0000-0000-0000-000000000006',
 1, 25, 20, 15, 1.7, 0.0075, 'YCS240814006-01', 'pending',
 '2024-01-14 17:40:00+00');

-- 6. 배송 추적 데이터
INSERT INTO shipment_tracking (
  id, order_id, tracking_number, carrier, status, location, 
  estimated_delivery, actual_delivery, notes, created_at, updated_at
) VALUES
('40000000-0000-0000-0000-000000000001', '10000000-0000-0000-0000-000000000001',
 'TH240815001', 'Thai Post', 'in_transit', '인천국제공항 출발',
 '2024-01-20 12:00:00+00', null, '항공편 탑재 완료',
 '2024-01-15 18:00:00+00', '2024-01-16 10:00:00+00'),

('40000000-0000-0000-0000-000000000002', '10000000-0000-0000-0000-000000000002', 
 'TH240810002', 'DHL', 'delivered', '태국 치앙마이 배송 완료',
 '2024-01-18 16:00:00+00', '2024-01-17 14:30:00+00', '수취인 직접 수령',
 '2024-01-12 20:00:00+00', '2024-01-17 14:30:00+00'),

('40000000-0000-0000-0000-000000000003', '10000000-0000-0000-0000-000000000003',
 'TH240812003', 'FedEx', 'out_for_delivery', '태국 푸켓 배송 중',
 '2024-01-16 15:00:00+00', null, '현지 배송 시작',
 '2024-01-13 22:00:00+00', '2024-01-16 08:00:00+00'),

('40000000-0000-0000-0000-000000000004', '10000000-0000-0000-0000-000000000004',
 'TH240813004', 'Kerry Express', 'warehouse_processing', '태국 방콕 허브센터',
 '2024-01-22 10:00:00+00', null, '통관 처리 중',
 '2024-01-14 16:00:00+00', '2024-01-15 14:00:00+00'),

('40000000-0000-0000-0000-000000000005', '10000000-0000-0000-0000-000000000005',
 'TH240805005', 'Thai Post', 'delivered', '태국 코사무이 배송 완료',
 '2024-01-10 14:00:00+00', '2024-01-09 16:20:00+00', '파트너 추천 고객 우선 배송',
 '2024-01-06 12:00:00+00', '2024-01-09 16:20:00+00');

-- 7. 견적 데이터
INSERT INTO estimates (
  id, order_id, version, total_amount, shipping_fee, repack_fee, 
  local_delivery_fee, insurance_fee, customs_fee, status,
  created_by, issued_date, valid_until, notes, created_at, updated_at
) VALUES
('50000000-0000-0000-0000-000000000001', '10000000-0000-0000-0000-000000000001',
 1, 150000, 120000, 0, 15000, 7500, 7500, 'approved',
 '00000000-0000-0000-0000-000000000005', '2024-01-15 12:00:00+00', '2024-01-22 12:00:00+00',
 '항공 배송 - 일반 견적', '2024-01-15 12:00:00+00', '2024-01-15 15:30:00+00'),

('50000000-0000-0000-0000-000000000002', '10000000-0000-0000-0000-000000000002',
 1, 280000, 200000, 30000, 20000, 14000, 16000, 'approved',
 '00000000-0000-0000-0000-000000000005', '2024-01-11 09:00:00+00', '2024-01-18 09:00:00+00',
 '해상 배송 + 리패킹', '2024-01-11 09:00:00+00', '2024-01-11 14:20:00+00'),

('50000000-0000-0000-0000-000000000003', '10000000-0000-0000-0000-000000000003',
 1, 520000, 400000, 0, 50000, 26000, 44000, 'paid',
 '00000000-0000-0000-0000-000000000005', '2024-01-12 18:00:00+00', '2024-01-19 18:00:00+00',
 '기업 대량 주문 - 긴급 배송', '2024-01-12 18:00:00+00', '2024-01-13 10:00:00+00'),

('50000000-0000-0000-0000-000000000004', '10000000-0000-0000-0000-000000000004',
 1, 750000, 500000, 80000, 60000, 37500, 72500, 'pending',
 '00000000-0000-0000-0000-000000000005', '2024-01-14 10:00:00+00', '2024-01-21 10:00:00+00',
 '기업 해상 대량 - 산업용품', '2024-01-14 10:00:00+00', '2024-01-14 10:00:00+00'),

('50000000-0000-0000-0000-000000000005', '10000000-0000-0000-0000-000000000005',
 1, 320000, 250000, 0, 25000, 16000, 29000, 'paid',
 '00000000-0000-0000-0000-000000000005', '2024-01-05 13:00:00+00', '2024-01-12 13:00:00+00',
 '파트너 추천 고객 - 특별 할인 적용', '2024-01-05 13:00:00+00', '2024-01-05 16:45:00+00');

-- 8. 결제 데이터
INSERT INTO payments (
  id, order_id, estimate_id, amount, payment_method, payment_status,
  payment_date, transaction_id, receipt_url, notes, created_at, updated_at  
) VALUES
('60000000-0000-0000-0000-000000000001', '10000000-0000-0000-0000-000000000001',
 '50000000-0000-0000-0000-000000000001', 150000, 'bank_transfer', 'completed',
 '2024-01-15 16:30:00+00', 'TXN240115001', 'https://receipt.example.com/001', 
 '국민은행 계좌이체', '2024-01-15 16:30:00+00', '2024-01-15 16:30:00+00'),

('60000000-0000-0000-0000-000000000002', '10000000-0000-0000-0000-000000000002',
 '50000000-0000-0000-0000-000000000002', 280000, 'credit_card', 'completed', 
 '2024-01-11 15:45:00+00', 'TXN240111002', 'https://receipt.example.com/002',
 '신용카드 결제', '2024-01-11 15:45:00+00', '2024-01-11 15:45:00+00'),

('60000000-0000-0000-0000-000000000003', '10000000-0000-0000-0000-000000000003',
 '50000000-0000-0000-0000-000000000003', 520000, 'bank_transfer', 'completed',
 '2024-01-13 11:00:00+00', 'TXN240113003', 'https://receipt.example.com/003',
 '기업 법인카드 결제', '2024-01-13 11:00:00+00', '2024-01-13 11:00:00+00'),

('60000000-0000-0000-0000-000000000005', '10000000-0000-0000-0000-000000000005',
 '50000000-0000-0000-0000-000000000005', 320000, 'bank_transfer', 'completed',
 '2024-01-05 17:30:00+00', 'TXN240105005', 'https://receipt.example.com/005',
 '파트너 추천 특별가 적용', '2024-01-05 17:30:00+00', '2024-01-05 17:30:00+00');

-- 9. 창고 스캔 이벤트 (현장관리자용)
INSERT INTO scan_events (
  id, order_id, box_id, user_id, scan_type, scan_location,
  scanned_at, notes, created_at
) VALUES
('70000000-0000-0000-0000-000000000001', '10000000-0000-0000-0000-000000000001',
 '30000000-0000-0000-0000-000000000001', '00000000-0000-0000-0000-000000000004',
 'inbound', '인천 물류센터 A동', '2024-01-15 14:30:00+00', 
 '입고 처리 완료 - 상태 양호', '2024-01-15 14:30:00+00'),

('70000000-0000-0000-0000-000000000002', '10000000-0000-0000-0000-000000000002', 
 '30000000-0000-0000-0000-000000000002', '00000000-0000-0000-0000-000000000004',
 'repack', '인천 물류센터 B동', '2024-01-11 10:15:00+00',
 '리패킹 작업 완료 - 2개 박스로 재포장', '2024-01-11 10:15:00+00'),

('70000000-0000-0000-0000-000000000003', '10000000-0000-0000-0000-000000000002',
 '30000000-0000-0000-0000-000000000003', '00000000-0000-0000-0000-000000000004', 
 'outbound', '인천 물류센터 출고장', '2024-01-12 16:00:00+00',
 '출고 처리 완료 - DHL 픽업', '2024-01-12 16:00:00+00'),

('70000000-0000-0000-0000-000000000004', '10000000-0000-0000-0000-000000000003',
 '30000000-0000-0000-0000-000000000004', '00000000-0000-0000-0000-000000000004',
 'outbound', '인천 물류센터 출고장', '2024-01-13 18:30:00+00',
 '긴급 출고 - FedEx 픽업', '2024-01-13 18:30:00+00'),

('70000000-0000-0000-0000-000000000005', '10000000-0000-0000-0000-000000000006',
 '30000000-0000-0000-0000-000000000008', '00000000-0000-0000-0000-000000000004',
 'hold', '인천 물류센터 보류구역', '2024-01-14 20:00:00+00',
 '회원코드 미기재로 보류', '2024-01-14 20:00:00+00');

-- 10. 파트너 추천 데이터
INSERT INTO partner_referrals (
  id, partner_id, referred_user_id, referral_code, commission_rate,
  total_orders, total_commission, status, created_at, updated_at
) VALUES
('80000000-0000-0000-0000-000000000001', '00000000-0000-0000-0000-000000000003',
 '00000000-0000-0000-0000-000000000001', 'REF001', 0.05,
 2, 23500, 'active', '2024-01-01 00:00:00+00', '2024-01-15 12:00:00+00');

-- 11. 알림 데이터
INSERT INTO notifications (
  id, user_id, title, message, type, is_read, 
  related_order_id, created_at
) VALUES
('90000000-0000-0000-0000-000000000001', '00000000-0000-0000-0000-000000000001',
 '주문 접수 완료', 'TEST-GEN-001 주문이 접수되었습니다.', 'order_status', false,
 '10000000-0000-0000-0000-000000000001', '2024-01-15 10:00:00+00'),

('90000000-0000-0000-0000-000000000002', '00000000-0000-0000-0000-000000000002',
 '견적서 발송', 'TEST-COR-001 견적서가 발송되었습니다.', 'estimate', true,
 '10000000-0000-0000-0000-000000000003', '2024-01-12 18:00:00+00'),

('90000000-0000-0000-0000-000000000003', '00000000-0000-0000-0000-000000000001', 
 '배송 지연 알림', '회원코드 미기재로 배송이 지연되고 있습니다.', 'delay_warning', false,
 '10000000-0000-0000-0000-000000000006', '2024-01-15 09:00:00+00'),

('90000000-0000-0000-0000-000000000004', '00000000-0000-0000-0000-000000000004',
 '입고 처리 완료', '5건의 박스 입고 처리가 완료되었습니다.', 'warehouse', true,
 null, '2024-01-15 17:00:00+00'),

('90000000-0000-0000-0000-000000000005', '00000000-0000-0000-0000-000000000005',
 '월간 리포트', '1월 전체 주문 현황 리포트가 준비되었습니다.', 'report', false,
 null, '2024-01-15 09:00:00+00');

-- 12. 시스템 설정
INSERT INTO system_config (
  id, config_key, config_value, description, updated_by, updated_at
) VALUES
('A0000000-0000-0000-0000-000000000001', 'cbm_threshold', '29.0', 
 'CBM 임계값 - 초과시 자동으로 항공배송 전환', '00000000-0000-0000-0000-000000000005', '2024-01-01 00:00:00+00'),

('A0000000-0000-0000-0000-000000000002', 'thb_threshold', '1500', 
 'THB 임계값 - 초과시 수취인 추가정보 필요', '00000000-0000-0000-0000-000000000005', '2024-01-01 00:00:00+00'),

('A0000000-0000-0000-0000-000000000003', 'partner_commission_rate', '0.05',
 '파트너 기본 수수료율', '00000000-0000-0000-0000-000000000005', '2024-01-01 00:00:00+00');

-- 데이터 생성 완료 메시지
SELECT 
  '테스트 데이터 생성 완료!' as message,
  (SELECT COUNT(*) FROM user_profiles WHERE email LIKE '%@test.com') as test_users,
  (SELECT COUNT(*) FROM orders WHERE order_number LIKE 'TEST-%') as test_orders,
  (SELECT COUNT(*) FROM order_items) as total_items,
  (SELECT COUNT(*) FROM order_boxes) as total_boxes;