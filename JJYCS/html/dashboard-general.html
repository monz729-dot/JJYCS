<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YSC 물류 시스템 - 개인 고객 대시보드</title>
    <link rel="stylesheet" href="css/globals.css">
    <style>
        .page-container {
            background: var(--gray-50);
            min-height: 100vh;
            padding-bottom: 5rem;
        }
        
        .header {
            background: white;
            border-bottom: 1px solid var(--primary-100);
            padding: 1rem;
            position: sticky;
            top: 0;
            z-index: 40;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
        }
        
        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header-left {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .logo {
            width: 2.5rem;
            height: 2.5rem;
            background: var(--primary-500);
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1rem;
        }
        
        .header-info h1 {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--primary-800);
            margin: 0;
        }
        
        .header-subtitle {
            font-size: 0.8rem;
            color: var(--gray-600);
            margin: 0;
        }
        
        .header-right {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .user-info {
            text-align: right;
        }
        
        .user-name {
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--primary-800);
        }
        
        .user-type {
            font-size: 0.75rem;
            color: #6b7280;
        }
        
        .logout-btn {
            background: none;
            border: 1px solid var(--primary-200);
            color: var(--primary-600);
            padding: 0.5rem 0.75rem;
            border-radius: 0.5rem;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .logout-btn:hover {
            background: var(--primary-50);
            border-color: var(--primary-300);
        }
        
        .main-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1.5rem 1rem;
        }
        
        .welcome-section {
            background: linear-gradient(135deg, var(--primary-500), var(--primary-600));
            color: white;
            border-radius: 1rem;
            padding: 2rem;
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
        }
        
        .welcome-section::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -10%;
            width: 200px;
            height: 200px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            animation: float 6s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }
        
        .welcome-content {
            position: relative;
            z-index: 1;
        }
        
        .welcome-title {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }
        
        .welcome-subtitle {
            opacity: 0.9;
            font-size: 1rem;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }
        
        .stat-card {
            background: white;
            border: 1px solid var(--primary-100);
            border-radius: 0.75rem;
            padding: 1.5rem;
            text-align: center;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
            transition: all 0.2s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary-600);
            margin-bottom: 0.5rem;
        }
        
        .stat-label {
            font-size: 0.875rem;
            color: #6b7280;
        }
        
        .section {
            background: white;
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border: 1px solid var(--primary-100);
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
        }
        
        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1.5rem;
        }
        
        .section-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--primary-800);
        }
        
        .section-action {
            font-size: 0.875rem;
            color: var(--primary-600);
            text-decoration: none;
        }
        
        .section-action:hover {
            text-decoration: underline;
        }
        
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }
        
        .action-card {
            background: white;
            border: 1px solid var(--primary-100);
            border-radius: 0.75rem;
            padding: 1.5rem;
            text-align: center;
            text-decoration: none;
            color: inherit;
            transition: all 0.2s ease;
            cursor: pointer;
        }
        
        .action-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            border-color: var(--primary-300);
        }
        
        .action-icon {
            width: 3rem;
            height: 3rem;
            background: var(--primary-100);
            border-radius: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1rem auto;
            color: var(--primary-600);
        }
        
        .action-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--primary-800);
            margin-bottom: 0.5rem;
        }
        
        .action-desc {
            font-size: 0.875rem;
            color: #6b7280;
            line-height: 1.4;
        }
        
        .order-list {
            space-y: 1rem;
        }
        
        .order-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem;
            background: #f8fafc;
            border-radius: 0.5rem;
            border: 1px solid #e5e7eb;
            margin-bottom: 0.75rem;
            transition: all 0.2s ease;
        }
        
        .order-item:hover {
            background: var(--primary-50);
            border-color: var(--primary-200);
        }
        
        .order-info {
            flex: 1;
        }
        
        .order-number {
            font-weight: 600;
            color: var(--primary-800);
            font-size: 0.875rem;
            margin-bottom: 0.25rem;
        }
        
        .order-desc {
            font-size: 0.8rem;
            color: #6b7280;
        }
        
        .order-meta {
            text-align: right;
            margin-left: 1rem;
        }
        
        .order-date {
            font-size: 0.75rem;
            color: #9ca3af;
            margin-bottom: 0.25rem;
        }
        
        .order-status {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 0.375rem;
            font-size: 0.7rem;
            font-weight: 500;
        }
        
        .status-pending {
            background: var(--warning-100);
            color: var(--warning-700);
        }
        
        .status-processing {
            background: var(--primary-100);
            color: var(--primary-700);
        }
        
        .status-shipping {
            background: #f0f9ff;
            color: #0369a1;
        }
        
        .status-delivered {
            background: var(--success-100);
            color: var(--success-700);
        }
        
        .status-billing {
            background: #fef3c7;
            color: #92400e;
        }
        
        .status-payment-pending {
            background: #fef2f2;
            color: #991b1b;
        }
        
        .status-payment-confirmed {
            background: #ecfdf5;
            color: #065f46;
        }
        
        .empty-state {
            text-align: center;
            padding: 3rem 1rem;
            color: #9ca3af;
        }
        
        .empty-icon {
            width: 4rem;
            height: 4rem;
            background: #f3f4f6;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1rem auto;
            font-size: 1.5rem;
        }
        
        .empty-title {
            font-size: 1rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
        }
        
        .empty-desc {
            font-size: 0.875rem;
        }
        
        @media (max-width: 768px) {
            .header-content {
                padding: 0 0.5rem;
            }
            
            .header-info h1 {
                font-size: 1rem;
            }
            
            .header-subtitle {
                font-size: 0.75rem;
            }
            
            .main-content {
                padding: 1rem 0.75rem;
            }
            
            .welcome-section {
                padding: 1.5rem;
            }
            
            .welcome-title {
                font-size: 1.25rem;
            }
            
            .welcome-subtitle {
                font-size: 0.875rem;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.75rem;
            }
            
            .stat-card {
                padding: 1rem;
            }
            
            .stat-value {
                font-size: 1.25rem;
            }
            
            .stat-label {
                font-size: 0.8rem;
            }
            
            .quick-actions {
                grid-template-columns: 1fr;
                gap: 0.75rem;
            }
            
            .action-card {
                padding: 1.25rem;
            }
            
            .section {
                padding: 1.25rem;
            }
            
            .order-item {
                flex-direction: column;
                align-items: stretch;
                gap: 0.75rem;
            }
            
            .order-meta {
                text-align: left;
                margin-left: 0;
                display: flex;
                justify-content: space-between;
                align-items: center;
            }
        }
    </style>
</head>
<body class="theme-general">
    <div class="page-container">
        <!-- 헤더 -->
        <header class="header">
            <div class="header-content">
                <div class="header-left">
                    <div class="logo">YSC</div>
                    <div class="header-info">
                        <h1>YSC 물류 시스템</h1>
                        <p class="header-subtitle">개인 고객 대시보드</p>
                    </div>
                </div>
                <div class="header-right">
                    <div class="user-info">
                        <div class="user-name" id="userName">김개인</div>
                        <div class="user-type">개인 고객</div>
                    </div>
                    <button class="logout-btn" onclick="logout()">로그아웃</button>
                </div>
            </div>
        </header>

        <!-- 메인 콘텐츠 -->
        <main class="main-content">
            <!-- 환영 섹션 -->
            <div class="welcome-section">
                <div class="welcome-content">
                    <h1 class="welcome-title">안녕하세요, <span id="welcomeName">김개인</span>님!</h1>
                    <p class="welcome-subtitle">오늘도 YSC와 함께 안전하고 빠른 배송을 시작하세요.</p>
                </div>
            </div>

            <!-- 통계 카드 -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="totalOrders">3</div>
                    <div class="stat-label">총 주문</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="pendingOrders">1</div>
                    <div class="stat-label">진행중인 주문</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="completedOrders">2</div>
                    <div class="stat-label">완료된 배송</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">₩85,000</div>
                    <div class="stat-label">이번 달 배송비</div>
                </div>
            </div>

            <!-- 빠른 작업 -->
            <div class="quick-actions">
                <a href="order-form-general.html" class="action-card">
                    <div class="action-icon">
                        <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                        </svg>
                    </div>
                    <div class="action-title">새 주문 접수</div>
                    <div class="action-desc">개인 배송 주문을 빠르게 접수하세요</div>
                </a>
                
                <a href="order-tracking.html" class="action-card">
                    <div class="action-icon">
                        <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
                        </svg>
                    </div>
                    <div class="action-title">배송 추적</div>
                    <div class="action-desc">실시간으로 배송 상태를 확인하세요</div>
                </a>
                
                <a href="order-history-general.html" class="action-card">
                    <div class="action-icon">
                        <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                    </div>
                    <div class="action-title">주문 내역</div>
                    <div class="action-desc">과거 주문 내역과 배송 기록을 확인하세요</div>
                </a>
            </div>

            <!-- 최근 주문 -->
            <div class="section">
                <div class="section-header">
                    <h2 class="section-title">최근 주문</h2>
                    <a href="order-history-general.html" class="section-action">전체보기</a>
                </div>
                
                <div class="order-list" id="recentOrders">
                    <div class="order-item">
                        <div class="order-info">
                            <div class="order-number">#YSC240822001</div>
                            <div class="order-desc">전자제품 • 태국 → 한국</div>
                        </div>
                        <div class="order-meta">
                            <div class="order-date">2024.08.22</div>
                            <span class="order-status status-billing">청구서발행</span>
                        </div>
                    </div>
                    
                    <div class="order-item">
                        <div class="order-info">
                            <div class="order-number">#YSC240821002</div>
                            <div class="order-desc">의류 3개 • 태국 → 한국</div>
                        </div>
                        <div class="order-meta">
                            <div class="order-date">2024.08.21</div>
                            <span class="order-status status-delivered">배송완료</span>
                        </div>
                    </div>
                    
                    <div class="order-item">
                        <div class="order-info">
                            <div class="order-number">#YSC240820003</div>
                            <div class="order-desc">화장품 5개 • 태국 → 한국</div>
                        </div>
                        <div class="order-meta">
                            <div class="order-date">2024.08.20</div>
                            <span class="order-status status-delivered">배송완료</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 창고 보관 현황 -->
            <div class="section">
                <div class="section-header">
                    <h2 class="section-title">
                        <svg style="width: 1.25rem; height: 1.25rem; display: inline; margin-right: 0.5rem;" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z"/>
                        </svg>
                        창고 보관 현황
                    </h2>
                </div>
                
                <div class="warehouse-items" id="warehouseItems">
                    <div class="order-item" style="border-left: 4px solid var(--primary-500);">
                        <div class="order-info">
                            <div class="order-number">#YSC240115001</div>
                            <div class="order-desc">빼빼로, 초콜릿 과자 • 2.5kg</div>
                            <div style="display: flex; align-items: center; gap: 0.5rem; margin-top: 0.25rem;">
                                <span style="display: inline-flex; align-items: center; padding: 0.125rem 0.5rem; background: var(--primary-100); color: var(--primary-700); border-radius: 9999px; font-size: 0.75rem; font-weight: 500; font-family: 'Monaco', 'Menlo', monospace;">
                                    A-01-03
                                </span>
                                <span style="font-size: 0.75rem; color: #6b7280;">
                                    A열 1행 3번
                                </span>
                            </div>
                        </div>
                        <div class="order-meta">
                            <div class="order-date">입고일: 2024.01.18</div>
                            <span class="order-status" style="background: #fef3c7; color: #92400e; border-color: #fbbf24;">리패킹완료</span>
                        </div>
                    </div>
                    
                    <div class="order-item" style="border-left: 4px solid #10b981;">
                        <div class="order-info">
                            <div class="order-number">#YSC240120005</div>
                            <div class="order-desc">한국 전통차 세트 • 1.8kg</div>
                            <div style="display: flex; align-items: center; gap: 0.5rem; margin-top: 0.25rem;">
                                <span style="display: inline-flex; align-items: center; padding: 0.125rem 0.5rem; background: #d1fae5; color: #065f46; border-radius: 9999px; font-size: 0.75rem; font-weight: 500; font-family: 'Monaco', 'Menlo', monospace;">
                                    B-02-15
                                </span>
                                <span style="font-size: 0.75rem; color: #6b7280;">
                                    B열 2행 15번
                                </span>
                            </div>
                        </div>
                        <div class="order-meta">
                            <div class="order-date">입고일: 2024.01.20</div>
                            <span class="order-status" style="background: #dcfce7; color: #166534; border-color: #bbf7d0;">보관중</span>
                        </div>
                    </div>
                </div>
                
                <div style="text-align: center; margin-top: 1rem;">
                    <p style="font-size: 0.875rem; color: #6b7280; margin-bottom: 0.5rem;">
                        💡 창고 위치는 관리자가 물품 입고 시 할당해드립니다
                    </p>
                    <button class="btn-outline" style="padding: 0.5rem 1rem; font-size: 0.875rem;" onclick="window.location.href='order-history-general.html'">
                        전체 보관 현황 보기
                    </button>
                </div>
            </div>
        </main>

        <!-- 하단 네비게이션 -->
        <nav class="mobile-nav">
            <div class="nav-grid">
                <button class="nav-item active" onclick="navigate('dashboard')">
                    <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
                    </svg>
                </button>
                <button class="nav-item" onclick="navigate('order-form')">
                    <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path>
                    </svg>
                </button>
                <button class="nav-item" onclick="navigate('order-history')">
                    <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                    </svg>
                </button>
                <button class="nav-item" onclick="navigate('mypage')">
                    <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                    </svg>
                </button>
                <button class="nav-item" onclick="navigate('page-list')">
                    <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 10h16M4 14h16M4 18h16"></path>
                    </svg>
                </button>
            </div>
        </nav>
    </div>

    <script src="js/api.js"></script>
    <script>
        // 현재 사용자 정보
        let currentUser = null;

        // 인증 확인
        function checkAuth() {
            currentUser = ycsAPI.getCurrentUser();
            
            if (!currentUser) {
                window.location.href = 'auth-login.html';
                return false;
            }
            
            // 사용자 정보 표시
            document.getElementById('userName').textContent = currentUser.name;
            document.getElementById('welcomeName').textContent = currentUser.name;
            
            return true;
        }

        // 네비게이션
        function navigate(page) {
            const routes = {
                'dashboard': 'dashboard-general.html',
                'order-form': 'order-form-general.html',
                'order-history': 'order-history-general.html',
                'mypage': 'mypage-general.html',
                'page-list': 'index.html'
            };
            
            if (routes[page]) {
                window.location.href = routes[page];
            }
        }

        // 로그아웃
        async function logout() {
            if (confirm('로그아웃 하시겠습니까?')) {
                await ycsAPI.logout();
                window.location.href = 'auth-login.html';
            }
        }

        // 주문 통계 업데이트
        async function updateOrderStats() {
            try {
                const userOrders = await ycsAPI.getOrdersByUser(currentUser.id);
                
                // 상태별 주문 개수 계산
                const statusCounts = userOrders.reduce((acc, order) => {
                    acc[order.status] = (acc[order.status] || 0) + 1;
                    return acc;
                }, {});

                const totalOrders = userOrders.length;
                const pendingOrders = (statusCounts.RECEIVED || 0) + (statusCounts.ARRIVED || 0) + 
                                    (statusCounts.REPACKING || 0) + (statusCounts.SHIPPING || 0);
                const completedOrders = (statusCounts.DELIVERED || 0) + (statusCounts.COMPLETED || 0);
                
                document.getElementById('totalOrders').textContent = totalOrders;
                document.getElementById('pendingOrders').textContent = pendingOrders;
                document.getElementById('completedOrders').textContent = completedOrders;
            } catch (error) {
                console.error('주문 통계 로드 실패:', error);
                // 오류 시 기본값 표시
                document.getElementById('totalOrders').textContent = '0';
                document.getElementById('pendingOrders').textContent = '0';
                document.getElementById('completedOrders').textContent = '0';
            }
        }

        // 최근 주문 업데이트
        async function updateRecentOrders() {
            try {
                const userOrders = await ycsAPI.getOrdersByUser(currentUser.id);
                const recentOrders = userOrders.slice(-3).reverse(); // 최근 3개만
                
                const recentOrdersContainer = document.getElementById('recentOrders');
                
                if (recentOrders.length === 0) {
                    recentOrdersContainer.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-icon">📦</div>
                            <div class="empty-title">주문 내역이 없습니다</div>
                            <div class="empty-desc">첫 번째 주문을 접수해보세요</div>
                        </div>
                    `;
                    return;
                }

                recentOrdersContainer.innerHTML = recentOrders.map(order => {
                    const statusClass = getStatusClass(order.status);
                    const statusText = getStatusText(order.status);
                    const orderDate = new Date(order.createdAt).toLocaleDateString('ko-KR');
                    const itemDesc = order.items && order.items.length > 0 
                        ? `${order.items[0].description}${order.items.length > 1 ? ` 외 ${order.items.length - 1}개` : ''}`
                        : '상품 정보 없음';

                    return `
                        <div class="order-item" onclick="window.location.href='order-detail.html?id=${order.orderNumber}'">
                            <div class="order-info">
                                <div class="order-number">#${order.orderNumber}</div>
                                <div class="order-desc">${itemDesc} • ${order.country}</div>
                            </div>
                            <div class="order-meta">
                                <div class="order-date">${orderDate}</div>
                                <span class="order-status ${statusClass}">${statusText}</span>
                            </div>
                        </div>
                    `;
                }).join('');
            } catch (error) {
                console.error('최근 주문 로드 실패:', error);
                document.getElementById('recentOrders').innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">❌</div>
                        <div class="empty-title">데이터 로드 실패</div>
                        <div class="empty-desc">잠시 후 다시 시도해주세요</div>
                    </div>
                `;
            }
        }

        // 창고 보관 현황 업데이트
        async function updateWarehouseItems() {
            try {
                const userOrders = await ycsAPI.getOrdersByUser(currentUser.id);
                const warehouseOrders = userOrders.filter(order => 
                    ['ARRIVED', 'REPACKING'].includes(order.status) && order.storageLocation
                );
                
                const warehouseItemsContainer = document.getElementById('warehouseItems');
                
                if (warehouseOrders.length === 0) {
                    warehouseItemsContainer.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-icon">🏪</div>
                            <div class="empty-title">보관 중인 상품이 없습니다</div>
                            <div class="empty-desc">창고에 도착한 상품이 여기에 표시됩니다</div>
                        </div>
                    `;
                    return;
                }

                warehouseItemsContainer.innerHTML = warehouseOrders.map(order => {
                    const itemDesc = order.items && order.items.length > 0 
                        ? `${order.items[0].description}${order.items.length > 1 ? ` 외 ${order.items.length - 1}개` : ''}`
                        : '상품 정보 없음';
                    const arrivedDate = new Date(order.arrivedAt).toLocaleDateString('ko-KR');
                    const statusText = order.status === 'REPACKING' ? '리패킹진행' : '보관중';
                    const statusColor = order.status === 'REPACKING' ? '#fef3c7' : '#dcfce7';
                    const statusTextColor = order.status === 'REPACKING' ? '#92400e' : '#166534';
                    
                    return `
                        <div class="order-item" style="border-left: 4px solid var(--primary-500);" onclick="window.location.href='order-detail.html?id=${order.orderNumber}'">
                            <div class="order-info">
                                <div class="order-number">#${order.orderNumber}</div>
                                <div class="order-desc">${itemDesc} • ${order.actualWeight || order.totalWeight}kg</div>
                                <div style="display: flex; align-items: center; gap: 0.5rem; margin-top: 0.25rem;">
                                    <span style="display: inline-flex; align-items: center; padding: 0.125rem 0.5rem; background: var(--primary-100); color: var(--primary-700); border-radius: 9999px; font-size: 0.75rem; font-weight: 500; font-family: 'Monaco', 'Menlo', monospace;">
                                        ${order.storageLocation}
                                    </span>
                                    <span style="font-size: 0.75rem; color: #6b7280;">
                                        ${order.storageArea}
                                    </span>
                                </div>
                            </div>
                            <div class="order-meta">
                                <div class="order-date">입고일: ${arrivedDate}</div>
                                <span class="order-status" style="background: ${statusColor}; color: ${statusTextColor};">${statusText}</span>
                            </div>
                        </div>
                    `;
                }).join('');
            } catch (error) {
                console.error('창고 보관 현황 로드 실패:', error);
            }
        }

        // 주문 상태별 CSS 클래스 반환
        function getStatusClass(status) {
            const statusClasses = {
                'RECEIVED': 'status-pending',
                'ARRIVED': 'status-processing',
                'REPACKING': 'status-processing',
                'SHIPPING': 'status-shipping',
                'DELIVERED': 'status-delivered',
                'BILLING': 'status-billing',
                'PAYMENT_PENDING': 'status-payment-pending',
                'PAYMENT_CONFIRMED': 'status-payment-confirmed',
                'COMPLETED': 'status-delivered'
            };
            return statusClasses[status] || 'status-pending';
        }

        // 주문 상태 텍스트 반환
        function getStatusText(status) {
            const statusTexts = {
                'RECEIVED': '접수완료',
                'ARRIVED': '창고도착',
                'REPACKING': '리패킹진행',
                'SHIPPING': '배송중',
                'DELIVERED': '배송완료',
                'BILLING': '청구서발행',
                'PAYMENT_PENDING': '입금대기',
                'PAYMENT_CONFIRMED': '입금확인',
                'COMPLETED': '완료'
            };
            return statusTexts[status] || status;
        }

        // 페이지 로드 시 실행
        document.addEventListener('DOMContentLoaded', async function() {
            if (checkAuth()) {
                await Promise.all([
                    updateOrderStats(),
                    updateRecentOrders(),
                    updateWarehouseItems()
                ]);
            }
        });
    </script>
</body>
</html>