<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>주문 내역 - YCS 물류관리시스템</title>
    <link rel="stylesheet" href="../../common/common.css">
    <link rel="stylesheet" href="../../common/ui.css">
    <style>
        .order-history-container {
            padding: 1rem;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        /* 헤더 스타일 */
        .header-section {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .header-title {
            font-size: 1.25rem;
            color: rgb(30 64 175);
            margin: 0;
        }

        /* 카드 스타일 */
        .card {
            background: white;
            border-radius: 0.75rem;
            box-shadow: 0 10px 40px rgba(37, 99, 235, 0.15);
            border: 1px solid rgb(219 234 254);
        }

        .card-content {
            padding: 1rem;
        }

        /* 검색 스타일 */
        .search-container {
            display: flex;
            gap: 0.5rem;
        }

        .search-input-container {
            position: relative;
            flex: 1;
        }

        .search-icon {
            position: absolute;
            left: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            width: 1rem;
            height: 1rem;
            color: rgb(156 163 175);
        }

        .search-input {
            width: 100%;
            height: 2.5rem;
            padding: 0 0.75rem 0 2.5rem;
            border: 1px solid rgb(209 213 219);
            border-radius: 0.375rem;
            font-size: 0.875rem;
        }

        .search-input:focus {
            outline: none;
            border-color: rgb(37 99 235);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        /* 탭 스타일 */
        .tabs {
            width: 100%;
        }

        .tabs-list {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            background: rgb(243 244 246);
            border-radius: 0.375rem;
            padding: 0.25rem;
        }

        .tabs-trigger {
            padding: 0.5rem 1rem;
            border: none;
            background: transparent;
            border-radius: 0.25rem;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            font-size: 0.875rem;
        }

        .tabs-trigger.active {
            background: white;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .tabs-content {
            margin-top: 1rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .tabs-content.hidden {
            display: none;
        }

        /* 배지 스타일 */
        .badge {
            display: inline-flex;
            align-items: center;
            padding: 0.125rem 0.5rem;
            font-size: 0.75rem;
            font-weight: 500;
            border-radius: 0.25rem;
        }

        .badge-secondary {
            background: rgb(243 244 246);
            color: rgb(107 114 128);
        }

        .badge-outline {
            background: transparent;
            border: 1px solid rgb(209 213 219);
            color: rgb(107 114 128);
        }

        /* 주문 상태별 배지 색상 */
        .status-received { background: rgb(219 234 254); color: rgb(30 64 175); }
        .status-arrived { background: rgb(220 252 231); color: rgb(22 163 74); }
        .status-repacking { background: rgb(255 237 213); color: rgb(194 65 12); }
        .status-billing { background: rgb(243 232 255); color: rgb(126 34 206); }
        .status-payment_pending { background: rgb(254 249 195); color: rgb(146 64 14); }
        .status-payment_confirmed { background: rgb(224 231 255); color: rgb(67 56 202); }
        .status-shipping { background: rgb(207 250 254); color: rgb(14 116 144); }
        .status-delivered { background: rgb(209 250 229); color: rgb(21 128 61); }

        /* 주문 카드 스타일 */
        .order-card {
            background: white;
            border-radius: 0.5rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            border: 1px solid rgb(229 231 235);
            padding: 1rem;
            transition: box-shadow 0.2s;
            cursor: pointer;
        }

        .order-card:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .order-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 0.75rem;
        }

        .order-info h3 {
            font-weight: 500;
            margin: 0 0 0.25rem;
        }

        .order-meta {
            font-size: 0.875rem;
            color: rgb(107 114 128);
            margin: 0;
        }

        .order-badges {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .order-details {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .order-detail-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
        }

        .order-detail-item svg {
            width: 1rem;
            height: 1rem;
            color: rgb(107 114 128);
        }

        /* 상태별 알림 박스 */
        .status-alert {
            margin-top: 0.75rem;
            padding: 0.75rem;
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 0.875rem;
        }

        .status-alert.billing {
            background: rgb(243 232 255);
        }

        .status-alert.billing svg {
            color: rgb(126 34 206);
        }

        .status-alert.billing p {
            color: rgb(107 33 168);
            margin: 0;
        }

        .status-alert.payment_pending {
            background: rgb(254 249 195);
        }

        .status-alert.payment_pending svg {
            color: rgb(217 119 6);
        }

        .status-alert.payment_pending p {
            color: rgb(146 64 14);
            margin: 0;
        }

        .status-alert.repacking {
            background: rgb(255 237 213);
        }

        .status-alert.repacking svg {
            color: rgb(234 88 12);
        }

        .status-alert.repacking p {
            color: rgb(194 65 12);
            margin: 0;
        }

        .status-alert.shipping {
            background: rgb(219 234 254);
        }

        .status-alert.shipping svg {
            color: rgb(37 99 235);
        }

        .status-alert.shipping p {
            color: rgb(29 78 216);
            margin: 0;
        }

        .status-alert.delivered {
            background: rgb(220 252 231);
        }

        .status-alert.delivered svg {
            color: rgb(22 163 74);
        }

        .status-alert.delivered p {
            color: rgb(21 128 61);
            margin: 0;
        }

        /* 버튼 스타일 */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            text-decoration: none;
        }

        .btn-outline {
            background: transparent;
            border: 1px solid rgb(209 213 219);
            color: rgb(107 114 128);
        }

        .btn-outline:hover {
            background: rgb(249 250 251);
        }

        .btn-primary {
            background: rgb(37 99 235);
            color: white;
        }

        .btn-primary:hover {
            background: rgb(29 78 216);
        }

        .btn-success {
            background: rgb(34 197 94);
            color: white;
        }

        .btn-success:hover {
            background: rgb(22 163 74);
        }

        .btn-sm {
            padding: 0.25rem 0.75rem;
            font-size: 0.75rem;
        }

        .btn-ghost {
            background: transparent;
            border: none;
            padding: 0.5rem;
        }

        .btn-ghost:hover {
            background: rgb(243 244 246);
        }

        /* 모달 스타일 */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
        }

        .modal.show {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: white;
            border-radius: 0.5rem;
            max-width: 40rem;
            width: calc(100% - 2rem);
            max-height: 90vh;
            overflow-y: auto;
            transform: scale(0.95);
            transition: transform 0.3s;
        }

        .modal.show .modal-content {
            transform: scale(1);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            border-bottom: 1px solid rgb(229 231 235);
        }

        .modal-title {
            font-size: 1.125rem;
            font-weight: 600;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .modal-body {
            padding: 1rem;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .modal-footer {
            padding: 1rem;
            border-top: 1px solid rgb(229 231 235);
            background: rgb(249 250 251);
        }

        .modal-section {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .modal-section h4 {
            font-weight: 500;
            margin: 0;
        }

        .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            padding: 0.75rem;
            background: rgb(249 250 251);
            border-radius: 0.375rem;
        }

        .info-item p {
            margin: 0;
        }

        .info-item .label {
            font-size: 0.875rem;
            color: rgb(107 114 128);
        }

        .info-item .value {
            font-weight: 500;
        }

        .item-list {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .item-card {
            padding: 0.75rem;
            background: rgb(239 246 255);
            border-radius: 0.375rem;
        }

        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
        }

        .item-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-top: 0.5rem;
            font-size: 0.875rem;
            color: rgb(107 114 128);
        }

        .warehouse-info, .recipient-info, .billing-info {
            padding: 0.75rem;
            border-radius: 0.375rem;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .warehouse-info {
            background: rgb(240 253 244);
        }

        .recipient-info {
            background: rgb(239 246 255);
        }

        .billing-info {
            background: rgb(243 232 255);
        }

        .info-row {
            display: flex;
            justify-content: space-between;
        }

        .billing-total {
            display: flex;
            justify-content: space-between;
            font-weight: 500;
            padding-top: 0.5rem;
            border-top: 1px solid rgb(209 213 219);
        }

        .billing-total .amount {
            font-size: 1.125rem;
        }

        .photo-badges {
            display: flex;
            gap: 0.25rem;
            margin-top: 0.25rem;
        }

        /* 툴팁 스타일 */
        .tooltip {
            position: relative;
            display: inline-block;
        }

        .tooltip-icon {
            width: 1rem;
            height: 1rem;
            color: rgb(234 88 12);
            cursor: help;
            transition: color 0.2s;
        }

        .tooltip-icon:hover {
            color: rgb(194 65 12);
        }

        .tooltip-content {
            visibility: hidden;
            opacity: 0;
            position: absolute;
            z-index: 1000;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            background: rgb(30 41 59);
            color: white;
            padding: 0.75rem;
            border-radius: 0.5rem;
            border-left: 4px solid;
            max-width: 20rem;
            font-size: 0.875rem;
            line-height: 1.4;
            transition: all 0.3s;
            white-space: nowrap;
        }

        .tooltip:hover .tooltip-content {
            visibility: visible;
            opacity: 1;
        }

        .tooltip-content.orange {
            border-left-color: rgb(251 146 60);
        }

        .tooltip-content.green {
            border-left-color: rgb(34 197 94);
        }

        .tooltip-content.cyan {
            border-left-color: rgb(8 145 178);
        }

        .tooltip-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .tooltip-header svg {
            width: 1rem;
            height: 1rem;
        }

        .tooltip-title {
            font-weight: 500;
        }

        .tooltip-body {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .tooltip-detail {
            background: rgb(55 65 81);
            padding: 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
        }

        /* 유틸리티 클래스 */
        .hidden {
            display: none !important;
        }

        .flex {
            display: flex;
        }

        .items-center {
            align-items: center;
        }

        .justify-between {
            justify-content: space-between;
        }

        .gap-2 {
            gap: 0.5rem;
        }

        .gap-4 {
            gap: 1rem;
        }

        .text-sm {
            font-size: 0.875rem;
        }

        .text-xs {
            font-size: 0.75rem;
        }

        .font-medium {
            font-weight: 500;
        }

        .font-mono {
            font-family: ui-monospace, SFMono-Regular, monospace;
        }
    </style>
</head>
<body>
    <!-- 메인 컨테이너 -->
    <div class="order-history-container">
        <!-- 헤더 -->
        <div class="header-section">
            <h1 class="header-title">주문 내역</h1>
            <div class="tooltip">
                <svg class="tooltip-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                </svg>
                <div class="tooltip-content orange">
                    <div class="tooltip-header">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" style="color: rgb(251 146 60);">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                        </svg>
                        <span class="tooltip-title" style="color: rgb(251 146 60);">주문 내역 관리</span>
                    </div>
                    <div class="tooltip-body">
                        <p style="margin: 0;">새로운 워크플로우가 적용되었습니다:</p>
                        <div class="tooltip-detail">
                            <p style="margin: 0;">• 접수완료 → YCS창고도착 → 리패킹진행</p>
                            <p style="margin: 0;">• 청구서발행 → 입금대기 → 입금확인</p>
                            <p style="margin: 0;">• 배송중 → 배송완료</p>
                            <p style="margin: 0;">• 무통장 입금만 지원</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 검색 -->
        <div class="card">
            <div class="card-content">
                <div class="search-container">
                    <div class="search-input-container">
                        <svg class="search-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                        </svg>
                        <input 
                            type="text" 
                            class="search-input" 
                            id="searchInput"
                            placeholder="주문번호 또는 품목명으로 검색"
                        >
                    </div>
                    <div class="tooltip">
                        <button class="btn btn-outline">검색</button>
                        <div class="tooltip-content green">
                            <div class="tooltip-header">
                                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" style="color: rgb(74 222 128);">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                                </svg>
                                <span class="tooltip-title" style="color: rgb(74 222 128);">실시간 검색</span>
                            </div>
                            <div class="tooltip-body">
                                <p style="margin: 0;">입력과 동시에 목록이 필터링됩니다</p>
                                <div class="tooltip-detail">
                                    <p style="margin: 0;">검색 대상: 주문번호, 품목명</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 주문 현황 탭 -->
        <div class="tabs">
            <div class="tabs-list">
                <button class="tabs-trigger active" data-tab="all">
                    <span>전체</span>
                    <span class="badge badge-secondary" id="allCount">3</span>
                </button>
                <button class="tabs-trigger" data-tab="processing">
                    <span>진행중</span>
                    <span class="badge badge-secondary" id="processingCount">2</span>
                </button>
                <button class="tabs-trigger" data-tab="payment">
                    <span>결제</span>
                    <span class="badge badge-secondary" id="paymentCount">1</span>
                </button>
                <button class="tabs-trigger" data-tab="completed">
                    <span>완료</span>
                    <span class="badge badge-secondary" id="completedCount">1</span>
                </button>
            </div>

            <!-- 전체 탭 -->
            <div class="tabs-content" id="tabAll">
                <div id="allOrders">
                    <!-- 동적으로 생성될 주문 목록 -->
                </div>
            </div>

            <!-- 진행중 탭 -->
            <div class="tabs-content hidden" id="tabProcessing">
                <div id="processingOrders">
                    <!-- 동적으로 생성될 주문 목록 -->
                </div>
            </div>

            <!-- 결제 탭 -->
            <div class="tabs-content hidden" id="tabPayment">
                <div id="paymentOrders">
                    <!-- 동적으로 생성될 주문 목록 -->
                </div>
            </div>

            <!-- 완료 탭 -->
            <div class="tabs-content hidden" id="tabCompleted">
                <div id="completedOrders">
                    <!-- 동적으로 생성될 주문 목록 -->
                </div>
            </div>
        </div>
    </div>

    <!-- 주문 상세 모달 -->
    <div class="modal" id="orderDetailModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">
                    주문 상세 정보
                    <div class="tooltip">
                        <svg style="width: 1rem; height: 1rem; color: rgb(37 99 235); cursor: help;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        <div class="tooltip-content cyan">
                            <div class="tooltip-header">
                                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" style="color: rgb(103 232 249);">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                </svg>
                                <span class="tooltip-title" style="color: rgb(103 232 249);">상세 정보 모달</span>
                            </div>
                            <div class="tooltip-body">
                                <p style="margin: 0;">주문의 모든 정보를 확인할 수 있습니다</p>
                                <div class="tooltip-detail">
                                    <p style="margin: 0;">품목, 배송, 창고, 청구서 정보 포함</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <button class="btn btn-ghost" onclick="closeOrderDetailModal()" style="font-size: 1.5rem;">×</button>
            </div>
            
            <div class="modal-body" id="modalBody">
                <!-- 동적으로 생성될 상세 정보 -->
            </div>

            <div class="modal-footer">
                <div class="flex gap-2">
                    <button class="btn btn-outline flex-1" onclick="viewFullDetail()" id="fullDetailBtn">
                        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
                        </svg>
                        전체 상세보기
                    </button>
                    <button class="btn btn-outline flex-1 hidden" id="downloadBillBtn" onclick="downloadBill()">
                        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                        </svg>
                        청구서 다운로드
                    </button>
                    <button class="btn btn-success flex-1 hidden" id="paymentBtn" onclick="goToPayment()">
                        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"/>
                        </svg>
                        입금하기
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="../../common/common.js"></script>
    <script>
        // 상태 변수
        let selectedOrder = null;
        let filteredOrders = [];
        let searchTerm = '';

        // 주문 상태 정의
        const orderStatuses = {
            received: { label: '접수완료', description: '우체국 송장번호 등록, 주문 생성됨' },
            arrived: { label: 'YCS창고도착', description: '창고 도착, 무게 확인' },
            repacking: { label: '리패킹진행', description: '리패킹 작업 및 사진 업로드' },
            billing: { label: '청구서발행', description: '최종 비용 산정 및 청구서 발행' },
            payment_pending: { label: '입금대기', description: '무통장 입금 대기 중' },
            payment_confirmed: { label: '입금확인', description: '입금 확인 완료' },
            shipping: { label: '배송중', description: '태국 현지 배송 진행' },
            delivered: { label: '배송완료', description: '최종 배송 완료' }
        };

        // Mock 주문 데이터
        const orders = [
            {
                id: 'YCS-2024-001',
                orderNumber: 'YCS-240115-001',
                date: '2024-01-15',
                status: 'payment_pending',
                items: [
                    { name: '빼빼로 초콜릿', quantity: 10, weight: 1.5, unitPrice: 25, cbm: 0.015 }
                ],
                shippingType: '해상',
                trackingNumber: 'EE123456789KR',
                destination: '태국 방콕',
                recipient: {
                    name: '김수취',
                    phone: '+66-123-456-789',
                    address: '방콕시 중심가 123번지',
                    postalCode: '10110'
                },
                warehouse: {
                    arrivedDate: '2024-01-18',
                    actualWeight: 1.8,
                    repackingRequested: true,
                    repackingCompleted: true,
                    photos: ['arrival_photo.jpg', 'repacking_photo.jpg']
                },
                billing: {
                    proformaIssued: true,
                    finalIssued: false,
                    localDeliveryFee: 25000,
                    shippingFee: 85000,
                    tax: 7700,
                    total: 117700,
                    paymentMethod: 'manual_deposit',
                    paymentStatus: 'pending'
                }
            },
            {
                id: 'YCS-2024-002',
                orderNumber: 'YCS-240114-002',
                date: '2024-01-14',
                status: 'billing',
                items: [
                    { name: '전자제품', quantity: 2, weight: 2.0, unitPrice: 1200, cbm: 0.032 },
                    { name: '액세서리', quantity: 5, weight: 0.5, unitPrice: 300, cbm: 0.008 }
                ],
                shippingType: '항공',
                trackingNumber: 'EE987654321KR',
                destination: '태국 치앙마이',
                recipient: {
                    name: '이수취',
                    phone: '+66-987-654-321',
                    address: '치앙마이시 올드타운 456번지',
                    postalCode: '50200'
                },
                warehouse: {
                    arrivedDate: '2024-01-16',
                    actualWeight: 2.3,
                    repackingRequested: false,
                    repackingCompleted: false,
                    photos: ['arrival_photo_2.jpg']
                },
                billing: {
                    proformaIssued: true,
                    finalIssued: false,
                    localDeliveryFee: 30000,
                    shippingFee: 125000,
                    tax: 10850,
                    total: 165850,
                    paymentMethod: 'manual_deposit',
                    paymentStatus: 'not_ready'
                }
            },
            {
                id: 'YCS-2024-003',
                orderNumber: 'YCS-240113-003',
                date: '2024-01-13',
                status: 'delivered',
                items: [
                    { name: '건강식품', quantity: 1, weight: 1.0, unitPrice: 150, cbm: 0.012 }
                ],
                shippingType: '해상',
                trackingNumber: 'EE456789123KR',
                destination: '태국 파타야',
                recipient: {
                    name: '박수취',
                    phone: '+66-456-789-123',
                    address: '파타야시 해변로 789번지',
                    postalCode: '20150'
                },
                warehouse: {
                    arrivedDate: '2024-01-15',
                    actualWeight: 1.2,
                    repackingRequested: false,
                    repackingCompleted: false,
                    photos: ['arrival_photo_3.jpg']
                },
                billing: {
                    proformaIssued: true,
                    finalIssued: true,
                    localDeliveryFee: 20000,
                    shippingFee: 75000,
                    tax: 6650,
                    total: 101650,
                    paymentMethod: 'manual_deposit',
                    paymentStatus: 'completed'
                }
            }
        ];

        // 초기화
        function initializePage() {
            filteredOrders = [...orders];
            setupEventListeners();
            renderAllTabs();
            updateTabCounts();
        }

        // 이벤트 리스너 설정
        function setupEventListeners() {
            // 검색 입력
            document.getElementById('searchInput').addEventListener('input', handleSearch);

            // 탭 클릭
            document.querySelectorAll('.tabs-trigger').forEach(trigger => {
                trigger.addEventListener('click', () => switchTab(trigger.dataset.tab));
            });
        }

        // 검색 처리
        function handleSearch(e) {
            searchTerm = e.target.value.toLowerCase();
            filteredOrders = orders.filter(order => 
                order.id.toLowerCase().includes(searchTerm) ||
                order.orderNumber.toLowerCase().includes(searchTerm) ||
                order.items.some(item => item.name.toLowerCase().includes(searchTerm))
            );
            renderAllTabs();
            updateTabCounts();
        }

        // 탭 전환
        function switchTab(tabName) {
            // 탭 버튼 활성화 상태 변경
            document.querySelectorAll('.tabs-trigger').forEach(trigger => {
                trigger.classList.remove('active');
            });
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');

            // 탭 컨텐츠 표시
            document.querySelectorAll('.tabs-content').forEach(content => {
                content.classList.add('hidden');
            });
            document.getElementById(`tab${tabName.charAt(0).toUpperCase() + tabName.slice(1)}`).classList.remove('hidden');
        }

        // 모든 탭 렌더링
        function renderAllTabs() {
            renderOrderList('allOrders', filteredOrders);
            renderOrderList('processingOrders', filteredOrders.filter(order => 
                ['received', 'arrived', 'repacking', 'billing'].includes(order.status)
            ));
            renderOrderList('paymentOrders', filteredOrders.filter(order => 
                ['payment_pending', 'payment_confirmed'].includes(order.status)
            ));
            renderOrderList('completedOrders', filteredOrders.filter(order => 
                order.status === 'delivered'
            ));
        }

        // 주문 목록 렌더링
        function renderOrderList(containerId, orderList) {
            const container = document.getElementById(containerId);
            
            if (orderList.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: rgb(107 114 128); padding: 2rem;">주문 내역이 없습니다.</p>';
                return;
            }

            container.innerHTML = orderList.map(order => `
                <div class="order-card" onclick="openOrderDetailModal('${order.id}')">
                    <div class="order-header">
                        <div class="order-info">
                            <h3>${order.orderNumber}</h3>
                            <p class="order-meta">${order.date} | ${order.shippingType} | ${order.trackingNumber}</p>
                        </div>
                        <div class="order-badges">
                            <span class="badge status-${order.status}">${orderStatuses[order.status].label}</span>
                            ${order.billing.proformaIssued ? `
                                <span class="badge badge-outline text-xs" style="border-color: rgb(196 181 253); color: rgb(126 34 206);">
                                    <svg width="12" height="12" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="margin-right: 0.25rem;">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                    </svg>
                                    청구서
                                </span>
                            ` : ''}
                            ${order.warehouse?.photos && order.warehouse.photos.length > 0 ? `
                                <span class="badge badge-outline text-xs">
                                    <svg width="12" height="12" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="margin-right: 0.25rem;">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"/>
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"/>
                                    </svg>
                                    사진
                                </span>
                            ` : ''}
                        </div>
                    </div>

                    <div class="order-details">
                        <div class="order-detail-item">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"/>
                            </svg>
                            <span>${order.items.map(item => `${item.name} (${item.quantity}개)`).join(', ')}</span>
                        </div>
                        <div class="order-detail-item">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"/>
                            </svg>
                            <span>${order.destination}</span>
                        </div>
                    </div>

                    ${getStatusAlert(order)}
                </div>
            `).join('');
        }

        // 상태별 알림 박스 생성
        function getStatusAlert(order) {
            switch (order.status) {
                case 'billing':
                    return `
                        <div class="status-alert billing">
                            <div class="flex items-center gap-2">
                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                </svg>
                                <p>청구서가 발행되었습니다. 총 결제금액: ${order.billing.total.toLocaleString()} THB</p>
                            </div>
                        </div>
                    `;
                case 'payment_pending':
                    return `
                        <div class="status-alert payment_pending">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-2">
                                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"/>
                                    </svg>
                                    <p>무통장 입금 대기 중입니다. 결제금액: ${order.billing.total.toLocaleString()} THB</p>
                                </div>
                                <button class="btn btn-success btn-sm" onclick="event.stopPropagation(); goToPaymentPage('${order.id}')">
                                    <svg width="12" height="12" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"/>
                                    </svg>
                                    입금하기
                                </button>
                            </div>
                        </div>
                    `;
                case 'repacking':
                    return `
                        <div class="status-alert repacking">
                            <div class="flex items-center gap-2">
                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                                </svg>
                                <p>${order.warehouse.repackingRequested ? '리패킹 작업이 진행 중입니다.' : '창고에서 상품을 검수 중입니다.'}</p>
                            </div>
                        </div>
                    `;
                case 'shipping':
                    return `
                        <div class="status-alert shipping">
                            <div class="flex items-center gap-2">
                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"/>
                                </svg>
                                <p>태국 현지에서 배송이 진행 중입니다.</p>
                            </div>
                        </div>
                    `;
                case 'delivered':
                    return `
                        <div class="status-alert delivered">
                            <div class="flex items-center gap-2">
                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                </svg>
                                <p>배송이 완료되었습니다. 최종 결제금액: ${order.billing.total.toLocaleString()} THB</p>
                            </div>
                        </div>
                    `;
                default:
                    return '';
            }
        }

        // 탭 카운트 업데이트
        function updateTabCounts() {
            document.getElementById('allCount').textContent = filteredOrders.length;
            document.getElementById('processingCount').textContent = 
                filteredOrders.filter(order => ['received', 'arrived', 'repacking', 'billing'].includes(order.status)).length;
            document.getElementById('paymentCount').textContent = 
                filteredOrders.filter(order => ['payment_pending', 'payment_confirmed'].includes(order.status)).length;
            document.getElementById('completedCount').textContent = 
                filteredOrders.filter(order => order.status === 'delivered').length;
        }

        // 주문 상세 모달 열기
        function openOrderDetailModal(orderId) {
            const order = orders.find(o => o.id === orderId);
            if (!order) return;

            selectedOrder = order;
            renderOrderDetailModal(order);
            document.getElementById('orderDetailModal').classList.add('show');
        }

        // 주문 상세 모달 닫기
        function closeOrderDetailModal() {
            document.getElementById('orderDetailModal').classList.remove('show');
            selectedOrder = null;
        }

        // 주문 상세 모달 렌더링
        function renderOrderDetailModal(order) {
            const modalBody = document.getElementById('modalBody');
            
            modalBody.innerHTML = `
                <!-- 기본 정보 -->
                <div class="modal-section">
                    <h4>기본 정보</h4>
                    <div class="info-grid">
                        <div class="info-item">
                            <p class="label">주문번호</p>
                            <p class="value">${order.orderNumber}</p>
                        </div>
                        <div class="info-item">
                            <p class="label">접수일</p>
                            <p class="value">${order.date}</p>
                        </div>
                        <div class="info-item">
                            <p class="label">상태</p>
                            <span class="badge status-${order.status}">${orderStatuses[order.status].label}</span>
                        </div>
                        <div class="info-item">
                            <p class="label">송장번호</p>
                            <p class="value font-mono text-sm">${order.trackingNumber}</p>
                        </div>
                    </div>
                </div>

                <!-- 품목 정보 -->
                <div class="modal-section">
                    <h4>품목 정보</h4>
                    <div class="item-list">
                        ${order.items.map((item, index) => `
                            <div class="item-card">
                                <div class="item-header">
                                    <div>
                                        <p class="font-medium">${item.name}</p>
                                        <div class="item-details">
                                            <div>수량: ${item.quantity}개</div>
                                            <div>중량: ${item.weight}kg</div>
                                            <div>단가: ${item.unitPrice?.toLocaleString()} THB</div>
                                            <div>CBM: ${item.cbm} m³</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>

                <!-- 창고 정보 -->
                ${order.warehouse ? `
                    <div class="modal-section">
                        <h4 class="flex items-center gap-2">
                            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"/>
                            </svg>
                            창고 정보
                        </h4>
                        <div class="warehouse-info">
                            ${order.warehouse.arrivedDate ? `
                                <div class="info-row">
                                    <span>창고 도착일:</span>
                                    <span>${order.warehouse.arrivedDate}</span>
                                </div>
                            ` : ''}
                            ${order.warehouse.actualWeight ? `
                                <div class="info-row">
                                    <span>실제 무게:</span>
                                    <span>${order.warehouse.actualWeight}kg</span>
                                </div>
                            ` : ''}
                            <div class="info-row">
                                <span>리패킹 신청:</span>
                                <span>${order.warehouse.repackingRequested ? '신청함' : '신청안함'}</span>
                            </div>
                            ${order.warehouse.repackingRequested ? `
                                <div class="info-row">
                                    <span>리패킹 완료:</span>
                                    <span class="badge ${order.warehouse.repackingCompleted ? 'badge-primary' : 'badge-secondary'}">
                                        ${order.warehouse.repackingCompleted ? '완료' : '진행중'}
                                    </span>
                                </div>
                            ` : ''}
                            ${order.warehouse.photos && order.warehouse.photos.length > 0 ? `
                                <div>
                                    <span class="text-sm font-medium">사진:</span>
                                    <div class="photo-badges">
                                        ${order.warehouse.photos.map(photo => `
                                            <span class="badge badge-outline text-xs">
                                                <svg width="12" height="12" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="margin-right: 0.25rem;">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"/>
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"/>
                                                </svg>
                                                ${photo.includes('arrival') ? '도착' : '리패킹'}
                                            </span>
                                        `).join('')}
                                    </div>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                ` : ''}

                <!-- 수취인 정보 -->
                <div class="modal-section">
                    <h4>수취인 정보</h4>
                    <div class="recipient-info">
                        <div class="info-row">
                            <span>이름:</span>
                            <span>${order.recipient.name}</span>
                        </div>
                        <div class="info-row">
                            <span>연락처:</span>
                            <span>${order.recipient.phone}</span>
                        </div>
                        <div class="info-row">
                            <span>우편번호:</span>
                            <span>${order.recipient.postalCode}</span>
                        </div>
                        <div>
                            <span>주소:</span>
                            <p class="text-sm" style="margin-top: 0.25rem;">${order.recipient.address}</p>
                        </div>
                    </div>
                </div>

                <!-- 청구서 정보 -->
                <div class="modal-section">
                    <h4 class="flex items-center gap-2">
                        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                        </svg>
                        청구서 정보
                    </h4>
                    <div class="billing-info">
                        <div class="info-grid" style="margin-bottom: 0.75rem;">
                            <div class="flex items-center gap-2">
                                <span>Proforma 청구서:</span>
                                <span class="badge ${order.billing.proformaIssued ? 'status-delivered' : 'badge-secondary'}">
                                    ${order.billing.proformaIssued ? '발행완료' : '미발행'}
                                </span>
                            </div>
                            <div class="flex items-center gap-2">
                                <span>Final 청구서:</span>
                                <span class="badge ${order.billing.finalIssued ? 'status-delivered' : 'badge-secondary'}">
                                    ${order.billing.finalIssued ? '발행완료' : '미발행'}
                                </span>
                            </div>
                        </div>

                        ${order.billing.total > 0 ? `
                            <div style="padding-top: 0.5rem; border-top: 1px solid rgb(209 213 219);">
                                <div class="info-row text-sm">
                                    <span>배송비:</span>
                                    <span>${order.billing.shippingFee.toLocaleString()} THB</span>
                                </div>
                                ${order.billing.localDeliveryFee > 0 ? `
                                    <div class="info-row text-sm">
                                        <span>현지 배송비:</span>
                                        <span>${order.billing.localDeliveryFee.toLocaleString()} THB</span>
                                    </div>
                                ` : ''}
                                <div class="info-row text-sm">
                                    <span>TAX 7%:</span>
                                    <span>${order.billing.tax.toLocaleString()} THB</span>
                                </div>
                                <div class="billing-total">
                                    <span>총 결제금액:</span>
                                    <span class="amount">${order.billing.total.toLocaleString()} THB</span>
                                </div>
                            </div>
                        ` : ''}

                        <div class="flex items-center gap-2" style="padding-top: 0.5rem;">
                            <span>결제 방식:</span>
                            <span class="badge badge-outline">무통장 입금</span>
                        </div>

                        <div class="flex items-center gap-2">
                            <span>결제 상태:</span>
                            <span class="badge ${
                                order.billing.paymentStatus === 'completed' ? 'status-delivered' :
                                order.billing.paymentStatus === 'pending' ? 'badge-secondary' : 'badge-outline'
                            }">
                                ${order.billing.paymentStatus === 'completed' ? '입금완료' :
                                  order.billing.paymentStatus === 'pending' ? '입금대기' : '미준비'}
                            </span>
                        </div>
                    </div>
                </div>
            `;

            // 모달 하단 버튼 상태 업데이트
            const downloadBtn = document.getElementById('downloadBillBtn');
            const paymentBtn = document.getElementById('paymentBtn');

            if (order.billing.proformaIssued) {
                downloadBtn.classList.remove('hidden');
            } else {
                downloadBtn.classList.add('hidden');
            }

            if (order.status === 'payment_pending' && order.billing.paymentStatus === 'pending') {
                paymentBtn.classList.remove('hidden');
            } else {
                paymentBtn.classList.add('hidden');
            }
        }

        // 전체 상세보기
        function viewFullDetail() {
            if (selectedOrder) {
                closeOrderDetailModal();
                navigateTo('order-detail', { orderId: selectedOrder.id });
            }
        }

        // 청구서 다운로드
        function downloadBill() {
            alert('청구서 다운로드 기능은 준비 중입니다.');
        }

        // 입금하기
        function goToPayment() {
            if (selectedOrder) {
                closeOrderDetailModal();
                navigateTo('payment', { orderId: selectedOrder.id });
            }
        }

        // 입금하기 (카드에서 직접)
        function goToPaymentPage(orderId) {
            navigateTo('payment', { orderId: orderId });
        }

        // 모달 외부 클릭 시 닫기
        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('modal')) {
                closeOrderDetailModal();
            }
        });

        // 페이지 초기화
        document.addEventListener('DOMContentLoaded', initializePage);
    </script>
</body>
</html>