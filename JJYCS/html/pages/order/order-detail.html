<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì£¼ë¬¸ ìƒì„¸ - YCS ë¬¼ë¥˜ ì‹œìŠ¤í…œ</title>
    <link rel="stylesheet" href="../../css/globals.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #f0f4ff 0%, #ffffff 50%, #f0f4ff 100%);
            min-height: 100vh;
            padding: 16px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            space-y: 24px;
        }
        
        /* í—¤ë” ìŠ¤íƒ€ì¼ */
        .header {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 24px;
        }
        
        .back-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: transparent;
            color: #2563eb;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .back-btn:hover {
            background: rgba(37, 99, 235, 0.1);
            color: #1d4ed8;
        }
        
        .page-title {
            font-size: 20px;
            font-weight: 700;
            color: #1e3a8a;
        }
        
        .page-subtitle {
            font-size: 14px;
            color: #2563eb;
        }
        
        /* ì¹´ë“œ ìŠ¤íƒ€ì¼ */
        .card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(37, 99, 235, 0.15);
            border: 1px solid rgba(37, 99, 235, 0.1);
            margin-bottom: 24px;
            overflow: hidden;
        }
        
        .card-header {
            padding: 20px 24px;
            border-bottom: 1px solid rgba(37, 99, 235, 0.1);
        }
        
        .card-title {
            font-size: 16px;
            font-weight: 600;
            color: #1e3a8a;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .card-title .title-with-icon {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .card-content {
            padding: 24px;
        }
        
        /* ì›Œí¬í”Œë¡œìš° ìŠ¤íƒ€ì¼ */
        .progress-container {
            margin-bottom: 24px;
        }
        
        .progress-info {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
            margin-bottom: 8px;
        }
        
        .progress-bar {
            height: 12px;
            background: #e5e7eb;
            border-radius: 6px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #2563eb, #3b82f6);
            transition: width 0.5s ease;
        }
        
        .workflow-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
        }
        
        .workflow-item {
            padding: 12px;
            border-radius: 8px;
            border: 1px solid;
            transition: all 0.3s;
        }
        
        .workflow-item.completed {
            background: rgba(34, 197, 94, 0.05);
            border-color: #bbf7d0;
        }
        
        .workflow-item.active {
            background: rgba(37, 99, 235, 0.05);
            border-color: #93c5fd;
        }
        
        .workflow-item.pending {
            background: #f9fafb;
            border-color: #e5e7eb;
        }
        
        .workflow-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }
        
        .workflow-icon {
            width: 16px;
            height: 16px;
        }
        
        .workflow-label {
            font-size: 14px;
            font-weight: 500;
        }
        
        .workflow-description {
            font-size: 12px;
            color: #6b7280;
            margin-bottom: 4px;
        }
        
        .workflow-date {
            font-size: 11px;
            color: #9ca3af;
        }
        
        /* ë°°ì§€ ìŠ¤íƒ€ì¼ */
        .badge {
            display: inline-flex;
            align-items: center;
            padding: 4px 10px;
            font-size: 12px;
            font-weight: 500;
            border-radius: 6px;
            border: 1px solid;
        }
        
        .badge.default {
            background: #22c55e;
            color: white;
            border-color: #22c55e;
        }
        
        .badge.secondary {
            background: #f3f4f6;
            color: #6b7280;
            border-color: #e5e7eb;
        }
        
        .badge.outline {
            background: transparent;
            color: #2563eb;
            border-color: #93c5fd;
        }
        
        .badge.active {
            background: #2563eb;
            color: white;
            border-color: #2563eb;
        }
        
        /* ì •ë³´ ê·¸ë¦¬ë“œ */
        .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
        }
        
        @media (max-width: 768px) {
            .info-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .info-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
        }
        
        .info-row:not(:last-child) {
            border-bottom: 1px solid rgba(37, 99, 235, 0.05);
        }
        
        .info-label {
            color: #2563eb;
            font-size: 14px;
        }
        
        .info-value {
            font-weight: 500;
            font-size: 14px;
            color: #374151;
        }
        
        .info-value.mono {
            font-family: 'Courier New', monospace;
        }
        
        /* í…Œì´ë¸” ìŠ¤íƒ€ì¼ */
        .table-container {
            overflow-x: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        thead {
            background: rgba(37, 99, 235, 0.03);
        }
        
        th {
            padding: 12px;
            text-align: left;
            font-size: 13px;
            font-weight: 600;
            color: #1e3a8a;
            border-bottom: 1px solid rgba(37, 99, 235, 0.1);
        }
        
        th.center {
            text-align: center;
        }
        
        th.right {
            text-align: right;
        }
        
        td {
            padding: 12px;
            font-size: 14px;
            border-bottom: 1px solid rgba(37, 99, 235, 0.05);
        }
        
        td.center {
            text-align: center;
        }
        
        td.right {
            text-align: right;
        }
        
        /* ë¹„ìš© ìƒì„¸ */
        .cost-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #f3f4f6;
        }
        
        .cost-label {
            color: #4b5563;
            font-size: 14px;
        }
        
        .cost-amount {
            font-weight: 500;
            font-size: 14px;
        }
        
        .cost-total {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px;
            background: rgba(37, 99, 235, 0.05);
            border-radius: 8px;
            margin-top: 16px;
        }
        
        .cost-total-label {
            font-weight: 700;
            font-size: 18px;
            color: #1e3a8a;
        }
        
        .cost-total-amount {
            font-weight: 700;
            font-size: 20px;
            color: #1e3a8a;
        }
        
        /* ì•Œë¦¼ ë°•ìŠ¤ */
        .alert-box {
            padding: 16px;
            border-radius: 8px;
            border: 1px solid;
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px;
        }
        
        .alert-box.warning {
            background: rgba(251, 191, 36, 0.05);
            border-color: #fcd34d;
        }
        
        .alert-content {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .alert-icon {
            width: 20px;
            height: 20px;
            color: #f59e0b;
        }
        
        .alert-text {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        
        .alert-title {
            font-weight: 500;
            color: #92400e;
        }
        
        .alert-description {
            font-size: 14px;
            color: #b45309;
        }
        
        /* ë²„íŠ¼ ê·¸ë£¹ */
        .button-group {
            display: flex;
            gap: 16px;
            padding-bottom: 80px;
            margin-top: 24px;
        }
        
        .btn {
            flex: 1;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 0 24px;
            height: 56px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            border: none;
            text-decoration: none;
        }
        
        .btn-outline {
            background: white;
            color: #2563eb;
            border: 1px solid #93c5fd;
        }
        
        .btn-outline:hover {
            background: rgba(37, 99, 235, 0.05);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #2563eb, #3b82f6);
            color: white;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }
        
        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 16px rgba(37, 99, 235, 0.4);
        }
        
        .btn-success {
            background: #22c55e;
            color: white;
        }
        
        .btn-success:hover {
            background: #16a34a;
        }
        
        /* ì‚¬ì§„ ë¦¬ìŠ¤íŠ¸ */
        .photo-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 8px;
        }
        
        .photo-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 4px 8px;
            font-size: 11px;
            background: rgba(37, 99, 235, 0.05);
            border: 1px solid #93c5fd;
            border-radius: 4px;
            color: #2563eb;
        }
        
        /* ë©”ëª¨ ë°•ìŠ¤ */
        .memo-box {
            padding: 12px;
            background: rgba(37, 99, 235, 0.05);
            border-radius: 8px;
            margin-top: 12px;
        }
        
        .memo-text {
            font-size: 14px;
            color: #1e3a8a;
        }
        
        /* íŠ¹ë³„ ìš”ì²­ì‚¬í•­ */
        .special-request {
            padding: 12px;
            background: rgba(251, 191, 36, 0.05);
            border: 1px solid #fcd34d;
            border-radius: 8px;
            color: #92400e;
            font-size: 14px;
        }
        
        .icon {
            width: 20px;
            height: 20px;
            display: inline-block;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- í—¤ë” -->
        <div class="header">
            <button class="back-btn" onclick="navigateToPage('order-history')">
                â† ì£¼ë¬¸ë‚´ì—­ìœ¼ë¡œ
            </button>
            <div>
                <h1 class="page-title">ì£¼ë¬¸ ìƒì„¸</h1>
                <p class="page-subtitle" id="orderNumber">YCS-240115-001 - ì²­êµ¬ì„œ ë° ë°°ì†¡ ì •ë³´</p>
            </div>
        </div>
        
        <!-- ì›Œí¬í”Œë¡œìš° í˜„í™© -->
        <div class="card">
            <div class="card-header">
                <div class="card-title">
                    <div class="title-with-icon">
                        ğŸšš ë°°ì†¡ ì›Œí¬í”Œë¡œìš°
                    </div>
                    <span class="badge outline" id="workflowProgress">4/8 ë‹¨ê³„ ì™„ë£Œ</span>
                </div>
            </div>
            <div class="card-content">
                <div class="progress-container">
                    <div class="progress-info">
                        <span>ì§„í–‰ë¥ </span>
                        <span id="progressPercent">50%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressBar" style="width: 50%"></div>
                    </div>
                </div>
                
                <div class="workflow-grid" id="workflowGrid">
                    <!-- ì›Œí¬í”Œë¡œìš° í•­ëª©ë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                </div>
            </div>
        </div>
        
        <!-- ê¸°ë³¸ ì •ë³´ -->
        <div class="info-grid">
            <!-- ì£¼ë¬¸ ì •ë³´ -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <div class="title-with-icon">
                            # ì£¼ë¬¸ ì •ë³´
                        </div>
                    </div>
                </div>
                <div class="card-content">
                    <div class="info-row">
                        <span class="info-label">ì£¼ë¬¸ë²ˆí˜¸</span>
                        <span class="info-value mono" id="orderNum">YCS-240115-001</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">ê³ ê° ì•„ì´ë””</span>
                        <span class="info-value mono" id="customerId">KYP001</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">ì ‘ìˆ˜ì¼</span>
                        <span class="info-value" id="orderDate">2024-01-15</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">ì†¡ì¥ë²ˆí˜¸</span>
                        <span class="info-value mono" id="trackingNum">EE123456789KR</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">ë°°ì†¡ìœ í˜•</span>
                        <span class="badge outline" id="shippingType">í•´ìƒìš´ì†¡</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">ëª©ì ì§€</span>
                        <span class="info-value" id="destination">íƒœêµ­ (10110)</span>
                    </div>
                </div>
            </div>
            
            <!-- ê³ ê° ì •ë³´ -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <div class="title-with-icon">
                            ğŸ‘¤ ê³ ê° ì •ë³´
                        </div>
                    </div>
                </div>
                <div class="card-content">
                    <div class="info-row">
                        <span class="info-label">ì´ë¦„</span>
                        <span class="info-value" id="customerName">ê¹€ì² ìˆ˜</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">ì´ë©”ì¼</span>
                        <span class="info-value" id="customerEmail">kimcs@email.com</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">ì—°ë½ì²˜</span>
                        <span class="info-value" id="customerPhone">010-1234-5678</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">íšŒì›ìœ í˜•</span>
                        <span class="badge outline" id="customerType">ì¼ë°˜íšŒì›</span>
                    </div>
                    <div class="info-row" id="companyNameRow" style="display: none;">
                        <span class="info-label">íšŒì‚¬ëª…</span>
                        <span class="info-value" id="companyName"></span>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ì°½ê³  ì •ë³´ -->
        <div class="card" id="warehouseCard" style="display: none;">
            <div class="card-header">
                <div class="card-title">
                    <div class="title-with-icon">
                        ğŸ“¦ YCS ì°½ê³  ì •ë³´
                    </div>
                </div>
            </div>
            <div class="card-content">
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px;">
                    <div class="info-row">
                        <span class="info-label">ì°½ê³ ë„ì°©ì¼</span>
                        <span class="info-value" id="arrivedDate">2024-01-18</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">ì‹¤ì œë¬´ê²Œ</span>
                        <span class="info-value" id="actualWeight">2.5kg</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">ë¦¬íŒ¨í‚¹</span>
                        <div style="display: flex; gap: 8px;">
                            <span class="badge default" id="repackingStatus">ì‹ ì²­í•¨</span>
                            <span class="badge default" id="repackingComplete" style="font-size: 10px;">ì™„ë£Œ</span>
                        </div>
                    </div>
                </div>
                
                <div class="photo-list" id="photoList">
                    <!-- ì‚¬ì§„ ë°°ì§€ë“¤ì´ ì—¬ê¸°ì— ì¶”ê°€ë©ë‹ˆë‹¤ -->
                </div>
                
                <div class="memo-box" id="warehouseMemo" style="display: none;">
                    <p class="memo-text">
                        <strong>ì°½ê³  ë©”ëª¨:</strong> <span id="warehouseNotes"></span>
                    </p>
                </div>
            </div>
        </div>
        
        <!-- ì²­êµ¬ì„œ ì •ë³´ -->
        <div class="card">
            <div class="card-header">
                <div class="card-title">
                    <div class="title-with-icon">
                        ğŸ“„ ì²­êµ¬ì„œ (Invoice)
                    </div>
                    <div style="display: flex; gap: 8px;">
                        <span class="badge default" id="proformaStatus" style="display: none;">Proforma ë°œí–‰</span>
                        <span class="badge default" id="finalStatus" style="display: none;">Final ë°œí–‰</span>
                    </div>
                </div>
            </div>
            <div class="card-content">
                <!-- ì²­êµ¬ì„œ ë°œí–‰ í˜„í™© -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 24px;">
                    <div style="padding: 12px; border: 1px solid #e5e7eb; border-radius: 8px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                            <span style="font-weight: 500; color: #7c3aed;">Proforma ì²­êµ¬ì„œ</span>
                            <span class="badge" id="proformaBadge">ë¯¸ë°œí–‰</span>
                        </div>
                        <p style="font-size: 14px; color: #6b7280;" id="proformaDate"></p>
                    </div>
                    
                    <div style="padding: 12px; border: 1px solid #e5e7eb; border-radius: 8px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                            <span style="font-weight: 500; color: #7c3aed;">Final ì²­êµ¬ì„œ</span>
                            <span class="badge secondary" id="finalBadge">ë¯¸ë°œí–‰</span>
                        </div>
                        <p style="font-size: 14px; color: #6b7280;" id="finalDate"></p>
                    </div>
                </div>
                
                <!-- ë¹„ìš© ìƒì„¸ -->
                <div id="costDetails" style="display: none;">
                    <h4 style="font-weight: 500; color: #1e3a8a; margin-bottom: 16px;">ë¹„ìš© ìƒì„¸</h4>
                    <div id="costItems">
                        <!-- ë¹„ìš© í•­ëª©ë“¤ì´ ì—¬ê¸°ì— ì¶”ê°€ë©ë‹ˆë‹¤ -->
                    </div>
                </div>
                
                <!-- ê²°ì œ ì •ë³´ -->
                <div style="margin-top: 24px;">
                    <h4 style="font-weight: 500; color: #1e3a8a; margin-bottom: 16px;">ê²°ì œ ì •ë³´</h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                        <div class="info-row">
                            <span class="info-label">ê²°ì œ ë°©ì‹</span>
                            <span class="badge outline">ë¬´í†µì¥ ì…ê¸ˆ</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">ê²°ì œ ìƒíƒœ</span>
                            <span class="badge secondary" id="paymentStatus">ì…ê¸ˆëŒ€ê¸°</span>
                        </div>
                        <div class="info-row" id="depositorRow" style="display: none;">
                            <span class="info-label">ì…ê¸ˆìëª…</span>
                            <span class="info-value" id="depositorName"></span>
                        </div>
                        <div class="info-row" id="paymentDateRow" style="display: none;">
                            <span class="info-label">ì…ê¸ˆì¼</span>
                            <span class="info-value" id="paymentDate"></span>
                        </div>
                    </div>
                    
                    <!-- ì…ê¸ˆ ëŒ€ê¸° ì•Œë¦¼ -->
                    <div class="alert-box warning" id="paymentAlert" style="display: none;">
                        <div class="alert-content">
                            <span class="alert-icon">â°</span>
                            <div class="alert-text">
                                <p class="alert-title">ë¬´í†µì¥ ì…ê¸ˆ ëŒ€ê¸° ì¤‘</p>
                                <p class="alert-description" id="paymentAmount"></p>
                            </div>
                        </div>
                        <button class="btn btn-success" onclick="navigateToPayment()">
                            ğŸ’³ ì…ê¸ˆí•˜ê¸°
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- í’ˆëª© ì •ë³´ -->
        <div class="card">
            <div class="card-header">
                <div class="card-title">
                    <div class="title-with-icon">
                        ğŸ“¦ í’ˆëª© ì •ë³´
                    </div>
                </div>
            </div>
            <div class="card-content">
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>í’ˆëª©</th>
                                <th class="center">ìˆ˜ëŸ‰</th>
                                <th class="center">ì¤‘ëŸ‰</th>
                                <th class="center">í¬ê¸°(cm)</th>
                                <th class="center">CBM</th>
                                <th class="center">ë¶€í”¼ë¬´ê²Œ</th>
                                <th class="right" id="priceHeader" style="display: none;">ë‹¨ê°€</th>
                            </tr>
                        </thead>
                        <tbody id="itemsTableBody">
                            <!-- í’ˆëª©ë“¤ì´ ì—¬ê¸°ì— ì¶”ê°€ë©ë‹ˆë‹¤ -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- ìˆ˜ì·¨ì¸ ì •ë³´ -->
        <div class="card">
            <div class="card-header">
                <div class="card-title">
                    <div class="title-with-icon">
                        ğŸ“ ìˆ˜ì·¨ì¸ ì •ë³´
                    </div>
                </div>
            </div>
            <div class="card-content">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                    <div class="info-row">
                        <span class="info-label">ìˆ˜ì·¨ì¸ ì´ë¦„</span>
                        <span class="info-value" id="recipientName">Somchai Jaidee</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">ì—°ë½ì²˜</span>
                        <span class="info-value" id="recipientPhone">+66-81-234-5678</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">ìš°í¸ë²ˆí˜¸</span>
                        <span class="info-value" id="recipientPostalCode">10110</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">êµ­ê°€</span>
                        <span class="info-value" id="recipientCountry">íƒœêµ­</span>
                    </div>
                </div>
                <div style="margin-top: 16px;">
                    <p class="info-label" style="margin-bottom: 8px;">ë°°ì†¡ì§€ ì£¼ì†Œ</p>
                    <p style="padding: 12px; background: #f9fafb; border-radius: 8px; font-weight: 500;" id="recipientAddress">
                        123 Sukhumvit Road, Watthana District, Bangkok
                    </p>
                </div>
            </div>
        </div>
        
        <!-- íŠ¹ë³„ ìš”ì²­ì‚¬í•­ -->
        <div class="card" id="specialRequestCard" style="display: none;">
            <div class="card-header">
                <div class="card-title">
                    <div class="title-with-icon">
                        âš ï¸ íŠ¹ë³„ ìš”ì²­ì‚¬í•­
                    </div>
                </div>
            </div>
            <div class="card-content">
                <p class="special-request" id="specialRequest"></p>
            </div>
        </div>
        
        <!-- í•˜ë‹¨ ë²„íŠ¼ -->
        <div class="button-group">
            <button class="btn btn-outline" onclick="navigateToPage('order-history')">
                ì£¼ë¬¸ë‚´ì—­ìœ¼ë¡œ
            </button>
            <button class="btn btn-outline" id="downloadBtn" style="display: none;" onclick="downloadInvoice()">
                â¬‡ ì²­êµ¬ì„œ ë‹¤ìš´ë¡œë“œ
            </button>
            <button class="btn btn-success" id="paymentBtn" style="display: none;" onclick="navigateToPayment()">
                ğŸ’³ ì…ê¸ˆí•˜ê¸°
            </button>
        </div>
    </div>
    
    <script src="../../js/utils.js"></script>
    <script>
        // ì£¼ë¬¸ ìƒì„¸ ë°ì´í„°
        let orderDetail = null;
        
        // í˜ì´ì§€ ì´ˆê¸°í™”
        function initPage() {
            const urlParams = new URLSearchParams(window.location.search);
            const orderId = urlParams.get('orderId') || 'YCS-2024-001';
            
            loadOrderDetail(orderId);
        }
        
        // ì£¼ë¬¸ ìƒì„¸ ë°ì´í„° ë¡œë“œ
        function loadOrderDetail(orderId) {
            // Mock ë°ì´í„°
            orderDetail = {
                orderId: orderId,
                orderNumber: 'YCS-240115-001',
                customerId: 'KYP001',
                orderDate: '2024-01-15',
                status: 'payment_pending',
                shippingType: 'sea',
                country: 'thailand',
                postalCode: '10110',
                
                customerName: 'ê¹€ì² ìˆ˜',
                customerEmail: 'kimcs@email.com',
                customerPhone: '010-1234-5678',
                customerType: 'general',
                
                recipientName: 'Somchai Jaidee',
                recipientPhone: '+66-81-234-5678',
                recipientAddress: '123 Sukhumvit Road, Watthana District, Bangkok',
                recipientPostalCode: '10110',
                
                items: [
                    {
                        id: '1',
                        hscode: '1905.31',
                        description: 'ë¹¼ë¹¼ë¡œ ì´ˆì½œë¦¿',
                        quantity: 10,
                        weight: 1.5,
                        width: 30,
                        height: 20,
                        depth: 5,
                        unitPrice: 25.00,
                        cbm: 0.003
                    },
                    {
                        id: '2',
                        hscode: '1806.32',
                        description: 'ì´ˆì½œë¦¿ ê³¼ì',
                        quantity: 5,
                        weight: 0.8,
                        width: 20,
                        height: 15,
                        depth: 3,
                        unitPrice: 15.00,
                        cbm: 0.0009
                    }
                ],
                
                trackingNumber: 'EE123456789KR',
                
                warehouse: {
                    arrivedDate: '2024-01-18',
                    actualWeight: 2.5,
                    repackingRequested: true,
                    repackingCompleted: true,
                    photos: ['arrival_240118.jpg', 'repacking_240118_1.jpg', 'repacking_240118_2.jpg'],
                    notes: 'ìƒí’ˆ ìƒíƒœ ì–‘í˜¸, 1kgì”© 3ê°œ í¬ì¥ìœ¼ë¡œ ë¶„í•  ì™„ë£Œ'
                },
                
                billing: {
                    proformaIssued: true,
                    proformaDate: '2024-01-19',
                    finalIssued: false,
                    shippingFee: 85000,
                    localDeliveryFee: 25000,
                    repackingFee: 15000,
                    handlingFee: 10000,
                    insuranceFee: 2000,
                    customsFee: 5000,
                    tax: 9975,
                    total: 151975,
                    paymentMethod: 'manual_deposit',
                    paymentStatus: 'pending',
                    depositorName: 'ê¹€ì² ìˆ˜'
                },
                
                specialRequests: 'ê¹¨ì§€ê¸° ì‰¬ìš´ ìƒí’ˆì´ë¯€ë¡œ ì‹ ì¤‘íˆ í¬ì¥ ë¶€íƒë“œë¦½ë‹ˆë‹¤.'
            };
            
            renderOrderDetail();
        }
        
        // ì£¼ë¬¸ ìƒì„¸ í™”ë©´ ë Œë”ë§
        function renderOrderDetail() {
            // ê¸°ë³¸ ì •ë³´ ì—…ë°ì´íŠ¸
            document.getElementById('orderNumber').textContent = `${orderDetail.orderNumber} - ì²­êµ¬ì„œ ë° ë°°ì†¡ ì •ë³´`;
            document.getElementById('orderNum').textContent = orderDetail.orderNumber;
            document.getElementById('customerId').textContent = orderDetail.customerId;
            document.getElementById('orderDate').textContent = orderDetail.orderDate;
            document.getElementById('trackingNum').textContent = orderDetail.trackingNumber;
            document.getElementById('shippingType').textContent = orderDetail.shippingType === 'air' ? 'í•­ê³µìš´ì†¡' : 'í•´ìƒìš´ì†¡';
            document.getElementById('destination').textContent = `${getCountryName(orderDetail.country)} (${orderDetail.postalCode})`;
            
            // ê³ ê° ì •ë³´
            document.getElementById('customerName').textContent = orderDetail.customerName;
            document.getElementById('customerEmail').textContent = orderDetail.customerEmail;
            document.getElementById('customerPhone').textContent = orderDetail.customerPhone;
            document.getElementById('customerType').textContent = orderDetail.customerType === 'corporate' ? 'ê¸°ì—…íšŒì›' : 'ì¼ë°˜íšŒì›';
            
            if (orderDetail.companyName) {
                document.getElementById('companyNameRow').style.display = 'flex';
                document.getElementById('companyName').textContent = orderDetail.companyName;
            }
            
            // ì›Œí¬í”Œë¡œìš° ë Œë”ë§
            renderWorkflow();
            
            // ì°½ê³  ì •ë³´
            if (orderDetail.warehouse.arrivedDate) {
                document.getElementById('warehouseCard').style.display = 'block';
                document.getElementById('arrivedDate').textContent = orderDetail.warehouse.arrivedDate;
                document.getElementById('actualWeight').textContent = `${orderDetail.warehouse.actualWeight}kg`;
                
                if (orderDetail.warehouse.repackingRequested) {
                    document.getElementById('repackingStatus').textContent = 'ì‹ ì²­í•¨';
                    document.getElementById('repackingComplete').style.display = orderDetail.warehouse.repackingCompleted ? 'inline-block' : 'none';
                }
                
                // ì‚¬ì§„ ë°°ì§€
                const photoList = document.getElementById('photoList');
                orderDetail.warehouse.photos.forEach((photo, index) => {
                    const badge = document.createElement('div');
                    badge.className = 'photo-badge';
                    badge.innerHTML = `ğŸ“· ${photo.includes('arrival') ? 'ë„ì°©ì‚¬ì§„' : 'ë¦¬íŒ¨í‚¹ì‚¬ì§„'} ${index + 1}`;
                    photoList.appendChild(badge);
                });
                
                // ì°½ê³  ë©”ëª¨
                if (orderDetail.warehouse.notes) {
                    document.getElementById('warehouseMemo').style.display = 'block';
                    document.getElementById('warehouseNotes').textContent = orderDetail.warehouse.notes;
                }
            }
            
            // ì²­êµ¬ì„œ ì •ë³´
            renderBilling();
            
            // í’ˆëª© ì •ë³´
            renderItems();
            
            // ìˆ˜ì·¨ì¸ ì •ë³´
            document.getElementById('recipientName').textContent = orderDetail.recipientName;
            document.getElementById('recipientPhone').textContent = orderDetail.recipientPhone;
            document.getElementById('recipientPostalCode').textContent = orderDetail.recipientPostalCode;
            document.getElementById('recipientCountry').textContent = getCountryName(orderDetail.country);
            document.getElementById('recipientAddress').textContent = orderDetail.recipientAddress;
            
            // íŠ¹ë³„ ìš”ì²­ì‚¬í•­
            if (orderDetail.specialRequests) {
                document.getElementById('specialRequestCard').style.display = 'block';
                document.getElementById('specialRequest').textContent = orderDetail.specialRequests;
            }
            
            // ë²„íŠ¼ í‘œì‹œ
            if (orderDetail.billing.proformaIssued) {
                document.getElementById('downloadBtn').style.display = 'flex';
            }
            
            if (orderDetail.status === 'payment_pending' && orderDetail.billing.paymentStatus === 'pending') {
                document.getElementById('paymentBtn').style.display = 'flex';
            }
        }
        
        // ì›Œí¬í”Œë¡œìš° ë Œë”ë§
        function renderWorkflow() {
            const workflowStatuses = [
                { key: 'received', label: 'ì ‘ìˆ˜ì™„ë£Œ', icon: 'âœ…', description: 'ìš°ì²´êµ­ ì†¡ì¥ë²ˆí˜¸ ë“±ë¡', completed: true, active: false, date: orderDetail.orderDate },
                { key: 'arrived', label: 'YCSì°½ê³ ë„ì°©', icon: 'ğŸ“¦', description: 'ì°½ê³  ë„ì°©, ë¬´ê²Œ í™•ì¸', completed: !!orderDetail.warehouse.arrivedDate, active: orderDetail.status === 'arrived', date: orderDetail.warehouse.arrivedDate },
                { key: 'repacking', label: 'ë¦¬íŒ¨í‚¹ì§„í–‰', icon: 'ğŸ”§', description: 'ë¦¬íŒ¨í‚¹ ì‘ì—… ë° ì‚¬ì§„ ì—…ë¡œë“œ', completed: orderDetail.warehouse.repackingCompleted, active: orderDetail.status === 'repacking' },
                { key: 'billing', label: 'ì²­êµ¬ì„œë°œí–‰', icon: 'ğŸ“„', description: 'ìµœì¢… ë¹„ìš© ì‚°ì •', completed: orderDetail.billing.proformaIssued, active: orderDetail.status === 'billing', date: orderDetail.billing.proformaDate },
                { key: 'payment_pending', label: 'ì…ê¸ˆëŒ€ê¸°', icon: 'â°', description: 'ë¬´í†µì¥ ì…ê¸ˆ ëŒ€ê¸°', completed: orderDetail.billing.paymentStatus === 'confirmed' || orderDetail.billing.paymentStatus === 'completed', active: orderDetail.status === 'payment_pending' },
                { key: 'payment_confirmed', label: 'ì…ê¸ˆí™•ì¸', icon: 'ğŸ’³', description: 'ì…ê¸ˆ í™•ì¸ ì™„ë£Œ', completed: orderDetail.billing.paymentStatus === 'completed', active: orderDetail.status === 'payment_confirmed', date: orderDetail.billing.paymentDate },
                { key: 'shipping', label: 'ë°°ì†¡ì¤‘', icon: 'ğŸšš', description: 'íƒœêµ­ í˜„ì§€ ë°°ì†¡', completed: orderDetail.status === 'delivered', active: orderDetail.status === 'shipping' },
                { key: 'delivered', label: 'ë°°ì†¡ì™„ë£Œ', icon: 'âœ…', description: 'ìµœì¢… ë°°ì†¡ ì™„ë£Œ', completed: orderDetail.status === 'delivered', active: false }
            ];
            
            const completedSteps = workflowStatuses.filter(s => s.completed).length;
            const progressValue = (completedSteps / workflowStatuses.length) * 100;
            
            document.getElementById('workflowProgress').textContent = `${completedSteps}/${workflowStatuses.length} ë‹¨ê³„ ì™„ë£Œ`;
            document.getElementById('progressPercent').textContent = `${Math.round(progressValue)}%`;
            document.getElementById('progressBar').style.width = `${progressValue}%`;
            
            const workflowGrid = document.getElementById('workflowGrid');
            workflowGrid.innerHTML = '';
            
            workflowStatuses.forEach(status => {
                const item = document.createElement('div');
                item.className = `workflow-item ${status.completed ? 'completed' : status.active ? 'active' : 'pending'}`;
                
                let statusBadge = '';
                if (status.active) {
                    statusBadge = '<span class="badge active" style="font-size: 10px;">ì§„í–‰ì¤‘</span>';
                } else if (status.completed && !status.active) {
                    statusBadge = '<span class="badge default" style="font-size: 10px;">ì™„ë£Œ</span>';
                }
                
                item.innerHTML = `
                    <div class="workflow-header">
                        <span class="workflow-icon">${status.icon}</span>
                        <span class="workflow-label" style="color: ${status.completed ? '#059669' : status.active ? '#2563eb' : '#6b7280'}">
                            ${status.label}
                        </span>
                    </div>
                    <p class="workflow-description">${status.description}</p>
                    ${status.date ? `<p class="workflow-date">${status.date}</p>` : ''}
                    ${statusBadge ? `<div style="margin-top: 8px;">${statusBadge}</div>` : ''}
                `;
                
                workflowGrid.appendChild(item);
            });
        }
        
        // ì²­êµ¬ì„œ ì •ë³´ ë Œë”ë§
        function renderBilling() {
            // ì²­êµ¬ì„œ ë°œí–‰ ìƒíƒœ
            if (orderDetail.billing.proformaIssued) {
                document.getElementById('proformaStatus').style.display = 'inline-block';
                document.getElementById('proformaBadge').className = 'badge default';
                document.getElementById('proformaBadge').textContent = 'ë°œí–‰ì™„ë£Œ';
                if (orderDetail.billing.proformaDate) {
                    document.getElementById('proformaDate').textContent = `ë°œí–‰ì¼: ${orderDetail.billing.proformaDate}`;
                }
            } else {
                document.getElementById('proformaBadge').className = 'badge secondary';
                document.getElementById('proformaBadge').textContent = 'ë¯¸ë°œí–‰';
            }
            
            if (orderDetail.billing.finalIssued) {
                document.getElementById('finalStatus').style.display = 'inline-block';
                document.getElementById('finalBadge').className = 'badge default';
                document.getElementById('finalBadge').textContent = 'ë°œí–‰ì™„ë£Œ';
                if (orderDetail.billing.finalDate) {
                    document.getElementById('finalDate').textContent = `ë°œí–‰ì¼: ${orderDetail.billing.finalDate}`;
                }
            }
            
            // ë¹„ìš© ìƒì„¸
            if (orderDetail.billing.proformaIssued) {
                document.getElementById('costDetails').style.display = 'block';
                const costItems = document.getElementById('costItems');
                
                const costs = [
                    { label: 'ê¸°ë³¸ ë°°ì†¡ë¹„', amount: orderDetail.billing.shippingFee },
                    { label: 'í˜„ì§€ ë°°ì†¡ë¹„', amount: orderDetail.billing.localDeliveryFee }
                ];
                
                if (orderDetail.billing.repackingFee > 0) {
                    costs.push({ label: 'ë¦¬íŒ¨í‚¹ ë¹„ìš©', amount: orderDetail.billing.repackingFee });
                }
                
                costs.push(
                    { label: 'ì·¨ê¸‰ ìˆ˜ìˆ˜ë£Œ', amount: orderDetail.billing.handlingFee },
                    { label: 'ë³´í—˜ë£Œ', amount: orderDetail.billing.insuranceFee },
                    { label: 'í†µê´€ ìˆ˜ìˆ˜ë£Œ', amount: orderDetail.billing.customsFee }
                );
                
                let html = '';
                costs.forEach(item => {
                    html += `
                        <div class="cost-item">
                            <span class="cost-label">${item.label}</span>
                            <span class="cost-amount">${formatCurrency(item.amount)}</span>
                        </div>
                    `;
                });
                
                html += `
                    <div class="cost-item">
                        <span class="cost-label">TAX 7%</span>
                        <span class="cost-amount">${formatCurrency(orderDetail.billing.tax)}</span>
                    </div>
                    <div class="cost-total">
                        <span class="cost-total-label">ì´ ê²°ì œê¸ˆì•¡</span>
                        <span class="cost-total-amount">${formatCurrency(orderDetail.billing.total)}</span>
                    </div>
                `;
                
                costItems.innerHTML = html;
            }
            
            // ê²°ì œ ìƒíƒœ
            const paymentStatusBadge = document.getElementById('paymentStatus');
            switch (orderDetail.billing.paymentStatus) {
                case 'completed':
                    paymentStatusBadge.className = 'badge default';
                    paymentStatusBadge.textContent = 'ì…ê¸ˆì™„ë£Œ';
                    break;
                case 'confirmed':
                    paymentStatusBadge.className = 'badge default';
                    paymentStatusBadge.textContent = 'ì…ê¸ˆí™•ì¸';
                    break;
                case 'pending':
                    paymentStatusBadge.className = 'badge secondary';
                    paymentStatusBadge.textContent = 'ì…ê¸ˆëŒ€ê¸°';
                    break;
                default:
                    paymentStatusBadge.className = 'badge outline';
                    paymentStatusBadge.textContent = 'ë¯¸ì¤€ë¹„';
            }
            
            if (orderDetail.billing.depositorName) {
                document.getElementById('depositorRow').style.display = 'flex';
                document.getElementById('depositorName').textContent = orderDetail.billing.depositorName;
            }
            
            if (orderDetail.billing.paymentDate) {
                document.getElementById('paymentDateRow').style.display = 'flex';
                document.getElementById('paymentDate').textContent = orderDetail.billing.paymentDate;
            }
            
            // ì…ê¸ˆ ëŒ€ê¸° ì•Œë¦¼
            if (orderDetail.status === 'payment_pending' && orderDetail.billing.paymentStatus === 'pending') {
                document.getElementById('paymentAlert').style.display = 'flex';
                document.getElementById('paymentAmount').textContent = `ê²°ì œê¸ˆì•¡: ${formatCurrency(orderDetail.billing.total)}`;
            }
        }
        
        // í’ˆëª© ì •ë³´ ë Œë”ë§
        function renderItems() {
            const tbody = document.getElementById('itemsTableBody');
            let html = '';
            
            if (orderDetail.customerType === 'corporate') {
                document.getElementById('priceHeader').style.display = 'table-cell';
            }
            
            orderDetail.items.forEach(item => {
                const volumetricWeight = (item.width * item.height * item.depth) / 6000;
                
                html += `
                    <tr>
                        <td>
                            ${orderDetail.customerType === 'corporate' ? `<p style="font-size: 11px; color: #9ca3af; margin-bottom: 4px; font-family: monospace;">${item.hscode}</p>` : ''}
                            <p style="font-weight: 500;">${item.description}</p>
                        </td>
                        <td class="center">${item.quantity}ê°œ</td>
                        <td class="center">${item.weight}kg</td>
                        <td class="center">${item.width}Ã—${item.height}Ã—${item.depth}</td>
                        <td class="center">
                            <span class="badge outline" style="font-size: 11px;">
                                ğŸ§® ${item.cbm}mÂ³
                            </span>
                        </td>
                        <td class="center">${volumetricWeight.toFixed(2)}kg</td>
                        ${orderDetail.customerType === 'corporate' ? `<td class="right">$${item.unitPrice.toFixed(2)}</td>` : ''}
                    </tr>
                `;
            });
            
            tbody.innerHTML = html;
        }
        
        // êµ­ê°€ëª… ë³€í™˜
        function getCountryName(country) {
            const countries = {
                'thailand': 'íƒœêµ­',
                'vietnam': 'ë² íŠ¸ë‚¨',
                'philippines': 'í•„ë¦¬í•€',
                'indonesia': 'ì¸ë„ë„¤ì‹œì•„'
            };
            return countries[country] || country;
        }
        
        // í†µí™” í¬ë§·
        function formatCurrency(amount, currency = 'THB') {
            if (currency === 'KRW') {
                return new Intl.NumberFormat('ko-KR').format(amount) + 'ì›';
            }
            return new Intl.NumberFormat('ko-KR').format(amount) + ' THB';
        }
        
        // í˜ì´ì§€ ë„¤ë¹„ê²Œì´ì…˜
        function navigateToPage(page, options = {}) {
            if (window.parent !== window) {
                window.parent.postMessage({
                    type: 'NAVIGATE',
                    page: page,
                    options: options
                }, '*');
            } else {
                window.location.href = `../${page}.html`;
            }
        }
        
        // ê²°ì œ í˜ì´ì§€ë¡œ ì´ë™
        function navigateToPayment() {
            navigateToPage('payment', { orderId: orderDetail.orderId });
        }
        
        // ì²­êµ¬ì„œ ë‹¤ìš´ë¡œë“œ
        function downloadInvoice() {
            window.print();
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', initPage);
    </script>
</body>
</html>