<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì£¼ë¬¸ ë‚´ì—­ - YCS ë¬¼ë¥˜ ì‹œìŠ¤í…œ</title>
    <link rel="stylesheet" href="../../css/globals.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #f0f4ff 0%, #ffffff 50%, #f0f4ff 100%);
            min-height: 100vh;
            padding: 16px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            animation: fadeIn 0.5s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 24px;
        }
        
        .title {
            font-size: 20px;
            font-weight: 700;
            color: #1e3a8a;
        }
        
        .tooltip {
            position: relative;
            display: inline-block;
        }
        
        .tooltip-trigger {
            cursor: help;
            color: #ea580c;
            font-size: 16px;
            transition: color 0.3s;
        }
        
        .tooltip-trigger:hover {
            color: #c2410c;
        }
        
        .tooltip-content {
            position: absolute;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            background: #1e3a8a;
            color: white;
            padding: 12px;
            border-radius: 6px;
            border-left: 4px solid #ea580c;
            font-size: 12px;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
            z-index: 100;
            max-width: 300px;
            white-space: normal;
            width: max-content;
        }
        
        .tooltip-content::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 4px solid transparent;
            border-top-color: #1e3a8a;
        }
        
        .tooltip:hover .tooltip-content {
            opacity: 1;
            visibility: visible;
        }
        
        .card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(37, 99, 235, 0.15);
            border: 1px solid rgba(37, 99, 235, 0.1);
            margin-bottom: 24px;
        }
        
        .card-header {
            padding: 16px 20px;
            border-bottom: 1px solid #f1f5f9;
        }
        
        .card-content {
            padding: 16px;
        }
        
        /* ê²€ìƒ‰ */
        .search-container {
            display: flex;
            gap: 8px;
        }
        
        .search-wrapper {
            position: relative;
            flex: 1;
        }
        
        .search-input {
            width: 100%;
            height: 40px;
            padding: 0 16px 0 40px;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            font-size: 14px;
            background: rgba(37, 99, 235, 0.03);
            transition: all 0.3s;
        }
        
        .search-input:focus {
            outline: none;
            border-color: #2563eb;
            background: white;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }
        
        .search-icon {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 16px;
            color: #9ca3af;
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 0 16px;
            height: 40px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            border: none;
            text-decoration: none;
        }
        
        .btn-outline {
            background: transparent;
            color: #2563eb;
            border: 1px solid #2563eb;
        }
        
        .btn-outline:hover {
            background: #2563eb;
            color: white;
        }
        
        .btn-ghost {
            background: transparent;
            color: #64748b;
            border: none;
        }
        
        .btn-ghost:hover {
            background: #f1f5f9;
        }
        
        .btn-primary {
            background: #2563eb;
            color: white;
            border: none;
        }
        
        .btn-primary:hover {
            background: #1d4ed8;
        }
        
        .btn-sm {
            height: 32px;
            padding: 0 12px;
            font-size: 12px;
        }
        
        /* íƒ­ */
        .tabs {
            margin-bottom: 24px;
        }
        
        .tab-list {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            background: rgba(37, 99, 235, 0.05);
            border-radius: 8px;
            padding: 4px;
            margin-bottom: 20px;
        }
        
        .tab-button {
            padding: 12px 16px;
            background: transparent;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            color: #64748b;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .tab-button.active {
            background: white;
            color: #1d4ed8;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .tab-button:hover:not(.active) {
            color: #475569;
        }
        
        .badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 500;
        }
        
        .badge-secondary {
            background: #f1f5f9;
            color: #64748b;
        }
        
        .badge-outline {
            background: transparent;
            border: 1px solid #e5e7eb;
            color: #64748b;
        }
        
        /* ìƒíƒœ ë°°ì§€ */
        .status-received { background: #dbeafe; color: #1d4ed8; }
        .status-arrived { background: #dcfce7; color: #15803d; }
        .status-repacking { background: #fed7aa; color: #ea580c; }
        .status-billing { background: #e9d5ff; color: #9333ea; }
        .status-payment_pending { background: #fef3c7; color: #d97706; }
        .status-payment_confirmed { background: #e0e7ff; color: #6366f1; }
        .status-shipping { background: #cffafe; color: #0891b2; }
        .status-delivered { background: #d1fae5; color: #059669; }
        
        /* ì£¼ë¬¸ ì¹´ë“œ */
        .order-card {
            transition: box-shadow 0.3s;
        }
        
        .order-card:hover {
            box-shadow: 0 12px 24px rgba(37, 99, 235, 0.2);
        }
        
        .order-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 12px;
        }
        
        .order-info {
            flex: 1;
        }
        
        .order-number {
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 4px;
        }
        
        .order-meta {
            font-size: 14px;
            color: #64748b;
        }
        
        .order-actions {
            display: flex;
            gap: 4px;
            align-items: center;
        }
        
        .order-details {
            margin-bottom: 12px;
        }
        
        .detail-row {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
            font-size: 14px;
        }
        
        .detail-icon {
            font-size: 16px;
            color: #64748b;
        }
        
        /* ìƒíƒœë³„ ì•Œë¦¼ ë°•ìŠ¤ */
        .status-alert {
            margin-top: 12px;
            padding: 12px;
            border-radius: 8px;
            font-size: 14px;
        }
        
        .alert-billing {
            background: #faf5ff;
            border: 1px solid #e9d5ff;
            color: #7c3aed;
        }
        
        .alert-payment {
            background: #fffbeb;
            border: 1px solid #fde68a;
            color: #d97706;
        }
        
        .alert-repacking {
            background: #fff7ed;
            border: 1px solid #fed7aa;
            color: #ea580c;
        }
        
        .alert-shipping {
            background: #ecfeff;
            border: 1px solid #a5f3fc;
            color: #0891b2;
        }
        
        .alert-delivered {
            background: #f0fdf4;
            border: 1px solid #bbf7d0;
            color: #059669;
        }
        
        .payment-section {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .btn-payment {
            background: #059669;
            color: white;
            border: none;
        }
        
        .btn-payment:hover {
            background: #047857;
        }
        
        /* ëª¨ë‹¬ */
        .modal {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 16px;
        }
        
        .modal.show {
            display: flex;
            animation: fadeIn 0.3s ease-out;
        }
        
        .modal-content {
            background: white;
            border-radius: 12px;
            max-width: 800px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideUp 0.3s ease-out;
        }
        
        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px 20px;
            border-bottom: 1px solid #f1f5f9;
        }
        
        .modal-title {
            font-size: 18px;
            font-weight: 600;
            color: #1e293b;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .modal-close {
            background: transparent;
            border: none;
            padding: 8px;
            cursor: pointer;
            border-radius: 4px;
            color: #64748b;
            font-size: 20px;
        }
        
        .modal-close:hover {
            background: #f1f5f9;
        }
        
        .modal-body {
            padding: 20px;
        }
        
        .section {
            margin-bottom: 24px;
        }
        
        .section-title {
            font-size: 16px;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .section-icon {
            font-size: 16px;
            color: #2563eb;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            padding: 12px;
            background: #f8fafc;
            border-radius: 8px;
        }
        
        .info-item {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        
        .info-label {
            font-size: 12px;
            color: #64748b;
            font-weight: 500;
        }
        
        .info-value {
            font-size: 14px;
            color: #1e293b;
            font-weight: 500;
        }
        
        .item-card {
            padding: 12px;
            background: #f0f9ff;
            border-radius: 8px;
            margin-bottom: 8px;
        }
        
        .item-name {
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 8px;
        }
        
        .item-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            font-size: 14px;
            color: #64748b;
        }
        
        .warehouse-info {
            padding: 12px;
            background: #f0fdf4;
            border-radius: 8px;
        }
        
        .billing-info {
            padding: 12px;
            background: #faf5ff;
            border-radius: 8px;
        }
        
        .cost-breakdown {
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid #e5e7eb;
        }
        
        .cost-row {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
            margin-bottom: 8px;
        }
        
        .cost-total {
            display: flex;
            justify-content: space-between;
            font-weight: 600;
            font-size: 16px;
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid #e5e7eb;
        }
        
        .modal-footer {
            padding: 16px 20px;
            border-top: 1px solid #f1f5f9;
            background: #f8fafc;
            display: flex;
            gap: 8px;
        }
        
        .btn-full {
            flex: 1;
        }
        
        .hidden {
            display: none !important;
        }
        
        /* ë°˜ì‘í˜• */
        @media (max-width: 768px) {
            .tab-list {
                grid-template-columns: repeat(2, 1fr);
                gap: 4px;
            }
            
            .order-header {
                flex-direction: column;
                gap: 12px;
            }
            
            .order-actions {
                align-self: stretch;
                justify-content: flex-end;
            }
            
            .info-grid {
                grid-template-columns: 1fr;
            }
            
            .item-details {
                grid-template-columns: 1fr;
            }
            
            .modal-content {
                margin: 0;
                border-radius: 12px 12px 0 0;
                max-height: 95vh;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- í—¤ë” -->
        <div class="header">
            <h1 class="title">ì£¼ë¬¸ ë‚´ì—­</h1>
            <div class="tooltip">
                <div class="tooltip-trigger">ğŸ“Š</div>
                <div class="tooltip-content">
                    <div style="color: #ea580c; font-weight: 600; margin-bottom: 8px;">ğŸ“Š ì£¼ë¬¸ ë‚´ì—­ ê´€ë¦¬</div>
                    <div style="font-size: 11px; line-height: 1.4;">
                        <p>ìƒˆë¡œìš´ ì›Œí¬í”Œë¡œìš°ê°€ ì ìš©ë˜ì—ˆìŠµë‹ˆë‹¤:</p>
                        <div style="background: #374151; padding: 8px; border-radius: 4px; margin-top: 8px;">
                            <p>â€¢ ì ‘ìˆ˜ì™„ë£Œ â†’ YCSì°½ê³ ë„ì°© â†’ ë¦¬íŒ¨í‚¹ì§„í–‰</p>
                            <p>â€¢ ì²­êµ¬ì„œë°œí–‰ â†’ ì…ê¸ˆëŒ€ê¸° â†’ ì…ê¸ˆí™•ì¸</p>
                            <p>â€¢ ë°°ì†¡ì¤‘ â†’ ë°°ì†¡ì™„ë£Œ</p>
                            <p>â€¢ ë¬´í†µì¥ ì…ê¸ˆë§Œ ì§€ì›</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ê²€ìƒ‰ -->
        <div class="card">
            <div class="card-content">
                <div class="search-container">
                    <div class="search-wrapper">
                        <span class="search-icon">ğŸ”</span>
                        <input 
                            type="text" 
                            id="searchInput"
                            class="search-input" 
                            placeholder="ì£¼ë¬¸ë²ˆí˜¸ ë˜ëŠ” í’ˆëª©ëª…ìœ¼ë¡œ ê²€ìƒ‰"
                        >
                    </div>
                    <div class="tooltip">
                        <button class="btn btn-outline tooltip-trigger">ê²€ìƒ‰</button>
                        <div class="tooltip-content">
                            <div style="color: #10b981; font-weight: 600; margin-bottom: 8px;">ğŸ” ì‹¤ì‹œê°„ ê²€ìƒ‰</div>
                            <p style="font-size: 11px;">ì…ë ¥ê³¼ ë™ì‹œì— ëª©ë¡ì´ í•„í„°ë§ë©ë‹ˆë‹¤</p>
                            <div style="background: #374151; padding: 6px; border-radius: 4px; margin-top: 8px; font-size: 10px;">
                                ê²€ìƒ‰ ëŒ€ìƒ: ì£¼ë¬¸ë²ˆí˜¸, í’ˆëª©ëª…
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- íƒ­ -->
        <div class="tabs">
            <div class="tab-list">
                <button class="tab-button active" data-tab="all">
                    <span>ì „ì²´</span>
                    <span class="badge badge-secondary" id="allCount">3</span>
                </button>
                <button class="tab-button" data-tab="processing">
                    <span>ì§„í–‰ì¤‘</span>
                    <span class="badge badge-secondary" id="processingCount">2</span>
                </button>
                <button class="tab-button" data-tab="payment">
                    <span>ê²°ì œ</span>
                    <span class="badge badge-secondary" id="paymentCount">1</span>
                </button>
                <button class="tab-button" data-tab="completed">
                    <span>ì™„ë£Œ</span>
                    <span class="badge badge-secondary" id="completedCount">1</span>
                </button>
            </div>
            
            <!-- íƒ­ ì½˜í…ì¸  -->
            <div id="ordersList">
                <!-- ì£¼ë¬¸ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
            </div>
        </div>
    </div>
    
    <!-- ì£¼ë¬¸ ìƒì„¸ ëª¨ë‹¬ -->
    <div id="orderModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">
                    <span>ğŸ“‹</span>
                    <span>ì£¼ë¬¸ ìƒì„¸ ì •ë³´</span>
                    <div class="tooltip">
                        <span class="tooltip-trigger" style="color: #2563eb; margin-left: 8px;">â„¹ï¸</span>
                        <div class="tooltip-content">
                            <div style="color: #2563eb; font-weight: 600; margin-bottom: 8px;">â„¹ï¸ ìƒì„¸ ì •ë³´ ëª¨ë‹¬</div>
                            <p style="font-size: 11px;">ì£¼ë¬¸ì˜ ëª¨ë“  ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</p>
                            <div style="background: #374151; padding: 6px; border-radius: 4px; margin-top: 8px; font-size: 10px;">
                                í’ˆëª©, ë°°ì†¡, ì°½ê³ , ì²­êµ¬ì„œ ì •ë³´ í¬í•¨
                            </div>
                        </div>
                    </div>
                </div>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div id="modalContent">
                    <!-- ëª¨ë‹¬ ë‚´ìš©ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline btn-full" onclick="viewFullDetail()">
                    ğŸ‘ï¸ ì „ì²´ ìƒì„¸ë³´ê¸°
                </button>
                <button class="btn btn-outline btn-full" id="downloadBillBtn" style="border-color: #a855f7; color: #a855f7;">
                    ğŸ“„ ì²­êµ¬ì„œ ë‹¤ìš´ë¡œë“œ
                </button>
                <button class="btn btn-payment btn-full" id="paymentBtn">
                    ğŸ’³ ì…ê¸ˆí•˜ê¸°
                </button>
            </div>
        </div>
    </div>
    
    <script src="../../js/utils.js"></script>
    <script>
        // ìƒíƒœ ë³€ìˆ˜
        let orders = [];
        let filteredOrders = [];
        let currentTab = 'all';
        let selectedOrder = null;
        
        // ì£¼ë¬¸ ìƒíƒœ ì •ì˜
        const orderStatuses = {
            'received': { label: 'ì ‘ìˆ˜ì™„ë£Œ', color: 'status-received', description: 'ìš°ì²´êµ­ ì†¡ì¥ë²ˆí˜¸ ë“±ë¡, ì£¼ë¬¸ ìƒì„±ë¨' },
            'arrived': { label: 'YCSì°½ê³ ë„ì°©', color: 'status-arrived', description: 'ì°½ê³  ë„ì°©, ë¬´ê²Œ í™•ì¸' },
            'repacking': { label: 'ë¦¬íŒ¨í‚¹ì§„í–‰', color: 'status-repacking', description: 'ë¦¬íŒ¨í‚¹ ì‘ì—… ë° ì‚¬ì§„ ì—…ë¡œë“œ' },
            'billing': { label: 'ì²­êµ¬ì„œë°œí–‰', color: 'status-billing', description: 'ìµœì¢… ë¹„ìš© ì‚°ì • ë° ì²­êµ¬ì„œ ë°œí–‰' },
            'payment_pending': { label: 'ì…ê¸ˆëŒ€ê¸°', color: 'status-payment_pending', description: 'ë¬´í†µì¥ ì…ê¸ˆ ëŒ€ê¸° ì¤‘' },
            'payment_confirmed': { label: 'ì…ê¸ˆí™•ì¸', color: 'status-payment_confirmed', description: 'ì…ê¸ˆ í™•ì¸ ì™„ë£Œ' },
            'shipping': { label: 'ë°°ì†¡ì¤‘', color: 'status-shipping', description: 'íƒœêµ­ í˜„ì§€ ë°°ì†¡ ì§„í–‰' },
            'delivered': { label: 'ë°°ì†¡ì™„ë£Œ', color: 'status-delivered', description: 'ìµœì¢… ë°°ì†¡ ì™„ë£Œ' }
        };
        
        // Mock ì£¼ë¬¸ ë°ì´í„°
        const mockOrders = [
            {
                id: 'YCS-2024-001',
                orderNumber: 'YCS-240115-001',
                date: '2024-01-15',
                status: 'payment_pending',
                items: [
                    { name: 'ë¹¼ë¹¼ë¡œ ì´ˆì½œë¦¿', quantity: 10, weight: 1.5, unitPrice: 25, cbm: 0.015 }
                ],
                shippingType: 'í•´ìƒ',
                trackingNumber: 'EE123456789KR',
                destination: 'íƒœêµ­ ë°©ì½•',
                recipient: {
                    name: 'ê¹€ìˆ˜ì·¨',
                    phone: '+66-123-456-789',
                    address: 'ë°©ì½•ì‹œ ì¤‘ì‹¬ê°€ 123ë²ˆì§€',
                    postalCode: '10110'
                },
                warehouse: {
                    arrivedDate: '2024-01-18',
                    actualWeight: 1.8,
                    repackingRequested: true,
                    repackingCompleted: true,
                    photos: ['arrival_photo.jpg', 'repacking_photo.jpg']
                },
                billing: {
                    proformaIssued: true,
                    finalIssued: false,
                    localDeliveryFee: 25000,
                    shippingFee: 85000,
                    tax: 7700,
                    total: 117700,
                    paymentMethod: 'manual_deposit',
                    paymentStatus: 'pending'
                }
            },
            {
                id: 'YCS-2024-002',
                orderNumber: 'YCS-240114-002',
                date: '2024-01-14',
                status: 'billing',
                items: [
                    { name: 'ì „ìì œí’ˆ', quantity: 2, weight: 2.0, unitPrice: 1200, cbm: 0.032 },
                    { name: 'ì•¡ì„¸ì„œë¦¬', quantity: 5, weight: 0.5, unitPrice: 300, cbm: 0.008 }
                ],
                shippingType: 'í•­ê³µ',
                trackingNumber: 'EE987654321KR',
                destination: 'íƒœêµ­ ì¹˜ì•™ë§ˆì´',
                recipient: {
                    name: 'ì´ìˆ˜ì·¨',
                    phone: '+66-987-654-321',
                    address: 'ì¹˜ì•™ë§ˆì´ì‹œ ì˜¬ë“œíƒ€ìš´ 456ë²ˆì§€',
                    postalCode: '50200'
                },
                warehouse: {
                    arrivedDate: '2024-01-16',
                    actualWeight: 2.3,
                    repackingRequested: false,
                    repackingCompleted: false,
                    photos: ['arrival_photo_2.jpg']
                },
                billing: {
                    proformaIssued: true,
                    finalIssued: false,
                    localDeliveryFee: 30000,
                    shippingFee: 125000,
                    tax: 10850,
                    total: 165850,
                    paymentMethod: 'manual_deposit',
                    paymentStatus: 'not_ready'
                }
            },
            {
                id: 'YCS-2024-003',
                orderNumber: 'YCS-240113-003',
                date: '2024-01-13',
                status: 'delivered',
                items: [
                    { name: 'ê±´ê°•ì‹í’ˆ', quantity: 1, weight: 1.0, unitPrice: 150, cbm: 0.012 }
                ],
                shippingType: 'í•´ìƒ',
                trackingNumber: 'EE456789123KR',
                destination: 'íƒœêµ­ íŒŒíƒ€ì•¼',
                recipient: {
                    name: 'ë°•ìˆ˜ì·¨',
                    phone: '+66-456-789-123',
                    address: 'íŒŒíƒ€ì•¼ì‹œ í•´ë³€ë¡œ 789ë²ˆì§€',
                    postalCode: '20150'
                },
                warehouse: {
                    arrivedDate: '2024-01-15',
                    actualWeight: 1.2,
                    repackingRequested: false,
                    repackingCompleted: false,
                    photos: ['arrival_photo_3.jpg']
                },
                billing: {
                    proformaIssued: true,
                    finalIssued: true,
                    localDeliveryFee: 20000,
                    shippingFee: 75000,
                    tax: 6650,
                    total: 101650,
                    paymentMethod: 'manual_deposit',
                    paymentStatus: 'completed'
                }
            }
        ];
        
        // ìƒíƒœ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
        function getStatusInfo(status) {
            return orderStatuses[status] || orderStatuses['received'];
        }
        
        // ì£¼ë¬¸ ì¹´ë“œ ìƒì„±
        function createOrderCard(order) {
            const statusInfo = getStatusInfo(order.status);
            const itemsText = order.items.map(item => `${item.name} (${item.quantity}ê°œ)`).join(', ');
            
            let statusAlert = '';
            
            // ìƒíƒœë³„ ì•Œë¦¼ ë°•ìŠ¤
            if (order.status === 'billing') {
                statusAlert = `
                    <div class="status-alert alert-billing">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span>ğŸ“„</span>
                            <span>ì²­êµ¬ì„œê°€ ë°œí–‰ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ ê²°ì œê¸ˆì•¡: ${order.billing.total.toLocaleString()} THB</span>
                        </div>
                    </div>
                `;
            } else if (order.status === 'payment_pending') {
                statusAlert = `
                    <div class="status-alert alert-payment">
                        <div class="payment-section">
                            <div style="display: flex; align-items: center; gap: 8px;">
                                <span>ğŸ’³</span>
                                <span>ë¬´í†µì¥ ì…ê¸ˆ ëŒ€ê¸° ì¤‘ì…ë‹ˆë‹¤. ê²°ì œê¸ˆì•¡: ${order.billing.total.toLocaleString()} THB</span>
                            </div>
                            <button class="btn btn-payment btn-sm" onclick="navigateToPayment('${order.id}')">
                                ğŸ’³ ì…ê¸ˆí•˜ê¸°
                            </button>
                        </div>
                    </div>
                `;
            } else if (order.status === 'repacking') {
                const message = order.warehouse.repackingRequested 
                    ? 'ë¦¬íŒ¨í‚¹ ì‘ì—…ì´ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤.'
                    : 'ì°½ê³ ì—ì„œ ìƒí’ˆì„ ê²€ìˆ˜ ì¤‘ì…ë‹ˆë‹¤.';
                statusAlert = `
                    <div class="status-alert alert-repacking">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span>ğŸ”§</span>
                            <span>${message}</span>
                        </div>
                    </div>
                `;
            } else if (order.status === 'shipping') {
                statusAlert = `
                    <div class="status-alert alert-shipping">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span>ğŸšš</span>
                            <span>íƒœêµ­ í˜„ì§€ì—ì„œ ë°°ì†¡ì´ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤.</span>
                        </div>
                    </div>
                `;
            } else if (order.status === 'delivered') {
                statusAlert = `
                    <div class="status-alert alert-delivered">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span>âœ…</span>
                            <span>ë°°ì†¡ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ìµœì¢… ê²°ì œê¸ˆì•¡: ${order.billing.total.toLocaleString()} THB</span>
                        </div>
                    </div>
                `;
            }
            
            return `
                <div class="card order-card">
                    <div class="card-content">
                        <div class="order-header">
                            <div class="order-info">
                                <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
                                    <span class="order-number">${order.orderNumber}</span>
                                    <span class="badge ${statusInfo.color}">${statusInfo.label}</span>
                                    ${order.billing.proformaIssued ? `
                                        <span class="badge badge-outline" style="border-color: #a855f7; color: #a855f7;">
                                            ğŸ“„ ì²­êµ¬ì„œ
                                        </span>
                                    ` : ''}
                                </div>
                                <div class="order-meta">
                                    ${order.date} | ${order.shippingType} | ${order.trackingNumber}
                                </div>
                            </div>
                            <div class="order-actions">
                                ${order.warehouse?.photos && order.warehouse.photos.length > 0 ? `
                                    <div class="tooltip">
                                        <span class="badge badge-outline tooltip-trigger">ğŸ“· ì‚¬ì§„</span>
                                        <div class="tooltip-content">
                                            ì°½ê³  ë„ì°© ë° ë¦¬íŒ¨í‚¹ ì‚¬ì§„ ìˆìŒ
                                        </div>
                                    </div>
                                ` : ''}
                                <div class="tooltip">
                                    <button class="btn btn-ghost btn-sm tooltip-trigger" onclick="showOrderDetail('${order.id}')">ğŸ‘ï¸</button>
                                    <div class="tooltip-content">
                                        ì£¼ë¬¸ ìƒì„¸ì •ë³´ ë³´ê¸°
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="order-details">
                            <div class="detail-row">
                                <span class="detail-icon">ğŸ“¦</span>
                                <span>${itemsText}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-icon">ğŸšš</span>
                                <span>${order.destination}</span>
                            </div>
                        </div>
                        
                        ${statusAlert}
                    </div>
                </div>
            `;
        }
        
        // ì£¼ë¬¸ ëª©ë¡ ë Œë”ë§
        function renderOrders() {
            const ordersList = document.getElementById('ordersList');
            
            if (filteredOrders.length === 0) {
                ordersList.innerHTML = `
                    <div style="text-align: center; padding: 60px 20px; color: #64748b;">
                        <div style="font-size: 64px; margin-bottom: 16px; opacity: 0.5;">ğŸ“¦</div>
                        <h3 style="font-size: 18px; font-weight: 600; margin-bottom: 8px;">ì¡°ê±´ì— ë§ëŠ” ì£¼ë¬¸ì´ ì—†ìŠµë‹ˆë‹¤</h3>
                        <p style="margin-bottom: 24px;">ë‹¤ë¥¸ ê²€ìƒ‰ì–´ë‚˜ í•„í„°ë¥¼ ì‚¬ìš©í•´ë³´ì„¸ìš”</p>
                        <button class="btn btn-primary" onclick="navigateToPage('order-form')">ìƒˆ ì£¼ë¬¸í•˜ê¸°</button>
                    </div>
                `;
                return;
            }
            
            ordersList.innerHTML = filteredOrders.map(order => createOrderCard(order)).join('');
        }
        
        // ì£¼ë¬¸ ìƒì„¸ ëª¨ë‹¬ í‘œì‹œ
        function showOrderDetail(orderId) {
            const order = orders.find(o => o.id === orderId);
            if (!order) return;
            
            selectedOrder = order;
            const statusInfo = getStatusInfo(order.status);
            
            const modalContent = document.getElementById('modalContent');
            modalContent.innerHTML = `
                <!-- ê¸°ë³¸ ì •ë³´ -->
                <div class="section">
                    <h4 class="section-title">ê¸°ë³¸ ì •ë³´</h4>
                    <div class="info-grid">
                        <div class="info-item">
                            <div class="info-label">ì£¼ë¬¸ë²ˆí˜¸</div>
                            <div class="info-value">${order.orderNumber}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">ì ‘ìˆ˜ì¼</div>
                            <div class="info-value">${order.date}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">í˜„ì¬ ìƒíƒœ</div>
                            <div class="info-value">
                                <span class="badge ${statusInfo.color}">${statusInfo.label}</span>
                            </div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">ì†¡ì¥ë²ˆí˜¸</div>
                            <div class="info-value" style="font-family: monospace;">${order.trackingNumber}</div>
                        </div>
                    </div>
                </div>
                
                <!-- í’ˆëª© ì •ë³´ -->
                <div class="section">
                    <h4 class="section-title">
                        <span class="section-icon">ğŸ“¦</span>
                        í’ˆëª© ì •ë³´
                    </h4>
                    ${order.items.map(item => `
                        <div class="item-card">
                            <div class="item-name">${item.name}</div>
                            <div class="item-details">
                                <div>ìˆ˜ëŸ‰: ${item.quantity}ê°œ</div>
                                <div>ì¤‘ëŸ‰: ${item.weight}kg</div>
                                <div>ë‹¨ê°€: ${item.unitPrice?.toLocaleString()} THB</div>
                                <div>CBM: ${item.cbm} mÂ³</div>
                            </div>
                        </div>
                    `).join('')}
                </div>
                
                <!-- ì°½ê³  ì •ë³´ -->
                ${order.warehouse ? `
                    <div class="section">
                        <h4 class="section-title">
                            <span class="section-icon">ğŸ“¦</span>
                            ì°½ê³  ì •ë³´
                        </h4>
                        <div class="warehouse-info">
                            ${order.warehouse.arrivedDate ? `
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span>ì°½ê³  ë„ì°©ì¼:</span>
                                    <span>${order.warehouse.arrivedDate}</span>
                                </div>
                            ` : ''}
                            ${order.warehouse.actualWeight ? `
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span>ì‹¤ì œ ë¬´ê²Œ:</span>
                                    <span>${order.warehouse.actualWeight}kg</span>
                                </div>
                            ` : ''}
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span>ë¦¬íŒ¨í‚¹ ì‹ ì²­:</span>
                                <span>${order.warehouse.repackingRequested ? 'ì‹ ì²­í•¨' : 'ì‹ ì²­ì•ˆí•¨'}</span>
                            </div>
                            ${order.warehouse.repackingRequested ? `
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span>ë¦¬íŒ¨í‚¹ ì™„ë£Œ:</span>
                                    <span class="badge ${order.warehouse.repackingCompleted ? 'status-delivered' : 'badge-secondary'}">
                                        ${order.warehouse.repackingCompleted ? 'ì™„ë£Œ' : 'ì§„í–‰ì¤‘'}
                                    </span>
                                </div>
                            ` : ''}
                            ${order.warehouse.photos && order.warehouse.photos.length > 0 ? `
                                <div>
                                    <span style="font-size: 14px; font-weight: 600;">ì‚¬ì§„:</span>
                                    <div style="display: flex; gap: 8px; margin-top: 8px;">
                                        ${order.warehouse.photos.map(photo => `
                                            <span class="badge badge-outline">
                                                ğŸ“· ${photo.includes('arrival') ? 'ë„ì°©' : 'ë¦¬íŒ¨í‚¹'}
                                            </span>
                                        `).join('')}
                                    </div>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                ` : ''}
                
                <!-- ìˆ˜ì·¨ì¸ ì •ë³´ -->
                <div class="section">
                    <h4 class="section-title">ìˆ˜ì·¨ì¸ ì •ë³´</h4>
                    <div class="info-grid">
                        <div class="info-item">
                            <div class="info-label">ì´ë¦„</div>
                            <div class="info-value">${order.recipient.name}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">ì—°ë½ì²˜</div>
                            <div class="info-value">${order.recipient.phone}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">ìš°í¸ë²ˆí˜¸</div>
                            <div class="info-value">${order.recipient.postalCode}</div>
                        </div>
                        <div class="info-item" style="grid-column: 1 / -1;">
                            <div class="info-label">ì£¼ì†Œ</div>
                            <div class="info-value">${order.recipient.address}</div>
                        </div>
                    </div>
                </div>
                
                <!-- ì²­êµ¬ì„œ ì •ë³´ -->
                <div class="section">
                    <h4 class="section-title">
                        <span class="section-icon">ğŸ“„</span>
                        ì²­êµ¬ì„œ ì •ë³´
                    </h4>
                    <div class="billing-info">
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; margin-bottom: 12px;">
                            <div style="display: flex; align-items: center; gap: 8px;">
                                <span>Proforma ì²­êµ¬ì„œ:</span>
                                <span class="badge ${order.billing.proformaIssued ? 'status-delivered' : 'badge-secondary'}">
                                    ${order.billing.proformaIssued ? 'ë°œí–‰ì™„ë£Œ' : 'ë¯¸ë°œí–‰'}
                                </span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 8px;">
                                <span>Final ì²­êµ¬ì„œ:</span>
                                <span class="badge ${order.billing.finalIssued ? 'status-delivered' : 'badge-secondary'}">
                                    ${order.billing.finalIssued ? 'ë°œí–‰ì™„ë£Œ' : 'ë¯¸ë°œí–‰'}
                                </span>
                            </div>
                        </div>
                        
                        ${order.billing.total > 0 ? `
                            <div class="cost-breakdown">
                                <div class="cost-row">
                                    <span>ë°°ì†¡ë¹„:</span>
                                    <span>${order.billing.shippingFee.toLocaleString()} THB</span>
                                </div>
                                ${order.billing.localDeliveryFee > 0 ? `
                                    <div class="cost-row">
                                        <span>í˜„ì§€ ë°°ì†¡ë¹„:</span>
                                        <span>${order.billing.localDeliveryFee.toLocaleString()} THB</span>
                                    </div>
                                ` : ''}
                                <div class="cost-row">
                                    <span>TAX 7%:</span>
                                    <span>${order.billing.tax.toLocaleString()} THB</span>
                                </div>
                                <div class="cost-total">
                                    <span>ì´ ê²°ì œê¸ˆì•¡:</span>
                                    <span>${order.billing.total.toLocaleString()} THB</span>
                                </div>
                            </div>
                        ` : ''}
                        
                        <div style="display: flex; align-items: center; gap: 8px; margin-top: 12px;">
                            <span>ê²°ì œ ë°©ì‹:</span>
                            <span class="badge badge-outline">ë¬´í†µì¥ ì…ê¸ˆ</span>
                        </div>
                        
                        <div style="display: flex; align-items: center; gap: 8px; margin-top: 8px;">
                            <span>ê²°ì œ ìƒíƒœ:</span>
                            <span class="badge ${
                                order.billing.paymentStatus === 'completed' ? 'status-delivered' :
                                order.billing.paymentStatus === 'pending' ? 'badge-secondary' : 'badge-outline'
                            }">
                                ${order.billing.paymentStatus === 'completed' ? 'ì…ê¸ˆì™„ë£Œ' :
                                  order.billing.paymentStatus === 'pending' ? 'ì…ê¸ˆëŒ€ê¸°' : 'ë¯¸ì¤€ë¹„'}
                            </span>
                        </div>
                    </div>
                </div>
            `;
            
            // ë²„íŠ¼ ìƒíƒœ ì„¤ì •
            const downloadBtn = document.getElementById('downloadBillBtn');
            const paymentBtn = document.getElementById('paymentBtn');
            
            downloadBtn.style.display = order.billing.proformaIssued ? 'flex' : 'none';
            paymentBtn.style.display = (order.status === 'payment_pending' && order.billing.paymentStatus === 'pending') ? 'flex' : 'none';
            
            document.getElementById('orderModal').classList.add('show');
        }
        
        // ëª¨ë‹¬ ë‹«ê¸°
        function closeModal() {
            document.getElementById('orderModal').classList.remove('show');
            selectedOrder = null;
        }
        
        // ì „ì²´ ìƒì„¸ë³´ê¸°
        function viewFullDetail() {
            if (selectedOrder) {
                closeModal();
                navigateToPage('order-detail', { orderId: selectedOrder.id });
            }
        }
        
        // ì…ê¸ˆí•˜ê¸°
        function navigateToPayment(orderId) {
            navigateToPage('payment', { orderId: orderId });
        }
        
        // ê²€ìƒ‰ ë° í•„í„°ë§
        function applyFilters() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            
            let filtered = orders.filter(order => {
                const matchesSearch = !searchTerm || 
                    order.id.toLowerCase().includes(searchTerm) ||
                    order.orderNumber.toLowerCase().includes(searchTerm) ||
                    order.items.some(item => item.name.toLowerCase().includes(searchTerm));
                
                // íƒ­ í•„í„°ë§
                if (currentTab === 'processing') {
                    return matchesSearch && ['received', 'arrived', 'repacking', 'billing'].includes(order.status);
                } else if (currentTab === 'payment') {
                    return matchesSearch && ['payment_pending', 'payment_confirmed'].includes(order.status);
                } else if (currentTab === 'completed') {
                    return matchesSearch && order.status === 'delivered';
                }
                
                return matchesSearch;
            });
            
            filteredOrders = filtered;
            renderOrders();
        }
        
        // íƒ­ ì¹´ìš´íŠ¸ ì—…ë°ì´íŠ¸
        function updateTabCounts() {
            const all = orders.length;
            const processing = orders.filter(o => ['received', 'arrived', 'repacking', 'billing'].includes(o.status)).length;
            const payment = orders.filter(o => ['payment_pending', 'payment_confirmed'].includes(o.status)).length;
            const completed = orders.filter(o => o.status === 'delivered').length;
            
            document.getElementById('allCount').textContent = all;
            document.getElementById('processingCount').textContent = processing;
            document.getElementById('paymentCount').textContent = payment;
            document.getElementById('completedCount').textContent = completed;
        }
        
        // í˜ì´ì§€ ë„¤ë¹„ê²Œì´ì…˜
        function navigateToPage(page, options = {}) {
            if (window.parent !== window) {
                window.parent.postMessage({
                    type: 'NAVIGATE',
                    page: page,
                    options: options
                }, '*');
            } else {
                let url = `../${page}.html`;
                if (options.orderId) url += `?orderId=${options.orderId}`;
                window.location.href = url;
            }
        }
        
        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
        document.addEventListener('DOMContentLoaded', function() {
            // ë°ì´í„° ì´ˆê¸°í™”
            orders = mockOrders;
            filteredOrders = [...orders];
            
            // íƒ­ ì¹´ìš´íŠ¸ ì—…ë°ì´íŠ¸
            updateTabCounts();
            
            // ì´ˆê¸° ë Œë”ë§
            renderOrders();
            
            // ê²€ìƒ‰ ì´ë²¤íŠ¸
            document.getElementById('searchInput').addEventListener('input', applyFilters);
            
            // íƒ­ ì´ë²¤íŠ¸
            document.querySelectorAll('.tab-button').forEach(button => {
                button.addEventListener('click', function() {
                    // í™œì„± íƒ­ ë³€ê²½
                    document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                    
                    // í˜„ì¬ íƒ­ ì—…ë°ì´íŠ¸
                    currentTab = this.dataset.tab;
                    
                    // í•„í„° ì ìš©
                    applyFilters();
                });
            });
            
            // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
            document.getElementById('orderModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeModal();
                }
            });
            
            // ESC í‚¤ë¡œ ëª¨ë‹¬ ë‹«ê¸°
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    closeModal();
                }
            });
            
            // ëª¨ë‹¬ ë²„íŠ¼ ì´ë²¤íŠ¸
            document.getElementById('downloadBillBtn').addEventListener('click', function() {
                if (selectedOrder) {
                    alert('ì²­êµ¬ì„œ ë‹¤ìš´ë¡œë“œ ê¸°ëŠ¥ì´ ì‹¤í–‰ë©ë‹ˆë‹¤.');
                }
            });
            
            document.getElementById('paymentBtn').addEventListener('click', function() {
                if (selectedOrder) {
                    closeModal();
                    navigateToPayment(selectedOrder.id);
                }
            });
        });
    </script>
</body>
</html>