# YCS 물류관리시스템 E2E 테스트 가이드

## 테스트 환경 준비

### 1. 서버 실행 확인
- 백엔드: http://localhost:8080/api
- 프론트엔드: http://localhost:3001

### 2. H2 데이터베이스 콘솔
- URL: http://localhost:8080/api/h2-console
- JDBC URL: jdbc:h2:mem:lmsdb
- 사용자명: sa
- 비밀번호: (빈 값)

## E2E 테스트 시나리오

### 시나리오 1: 일반 사용자 회원가입 및 주문 생성

#### 1.1 회원가입 테스트
1. http://localhost:3001/register 접속
2. 일반 고객 선택
3. 다음 정보로 회원가입:
   ```
   이름: 테스트 사용자
   전화번호: 010-1234-5678
   이메일: test@example.com
   비밀번호: test123!@#
   ```
4. 이메일 인증 테스트:
   - 인증 요청 클릭
   - 콘솔에서 인증코드 확인
   - 6자리 코드 입력하여 인증 완료
5. 약관 동의 후 가입하기 버튼 클릭
6. **예상 결과**: 
   - ✅ 개선된 토스트 메시지로 성공 알림
   - ✅ 유효성 검사 오류 시 InlineMessage 컴포넌트로 친화적 오류 표시

#### 1.2 로그인 테스트
1. http://localhost:3001/login 접속
2. 가입한 계정으로 로그인
3. **예상 결과**:
   - ✅ 성공 시 대시보드로 리디렉션
   - ✅ 실패 시 개선된 오류 메시지 표시

#### 1.3 주문 생성 테스트
1. 대시보드에서 "주문서 작성" 클릭
2. 기본 정보 입력:
   ```
   우체국 송장번호: EE123456789KR
   배송 국가: 태국
   수취인 이름: 김수취
   수취인 전화번호: 02-123-4567
   수취인 주소: 123 Test Street, Bangkok, Thailand
   수취인 우편번호: 10110
   ```

3. 품목 정보 입력 (테스트 케이스별):

#### 케이스 A: 정상 주문
```
HS 코드: 12345678
품목 설명: 테스트 상품
수량: 2
중량: 1.5kg
가로: 20cm, 세로: 15cm, 높이: 10cm
단가: 800 THB
```
**예상 결과**: ✅ 정상 접수, CBM과 THB 값이 임계값 미만

#### 케이스 B: CBM 임계값 초과 (29m³)
```
품목 1: 가로 100cm, 세로 100cm, 높이 100cm (1.0m³)
품목 2-30: 각각 가로 50cm, 세로 50cm, 높이 50cm (0.125m³)
총 CBM = 1.0 + (29 × 0.125) = 4.625m³
```
더 큰 치수로 29m³ 초과하도록 조정
**예상 결과**: 
- ✅ CBM 임계값 초과 경고 메시지 표시 (InlineMessage)
- ✅ 해상운송 → 항공운송 자동 전환 알림

#### 케이스 C: THB 임계값 초과 (1,500 THB)
```
단가: 2000 THB
수량: 1
```
**예상 결과**:
- ✅ THB 임계값 초과 경고 메시지 표시
- ✅ 수취인 추가 정보 필요 안내

#### 케이스 D: 회원코드 미기재 (No code)
**예상 결과**:
- ✅ 회원코드 미기재 경고 메시지 표시
- ✅ 발송 지연 가능성 안내

4. 주문 제출 버튼 클릭
5. **예상 결과**:
   - ✅ 성공 시 개선된 토스트 알림
   - ✅ 실패 시 구체적인 오류 메시지와 해결 방법 제시
   - ✅ 비즈니스 룰 위반 시 적절한 경고 메시지

### 시나리오 2: 기업 사용자 회원가입

#### 2.1 기업 회원가입 테스트
1. http://localhost:3001/register 접속
2. 기업 고객 선택
3. 기본 정보 + 사업자 정보 입력:
   ```
   회사명: (주)테스트기업
   사업자등록번호: 123-45-67890
   사업자등록증: 임시 이미지/PDF 파일 업로드
   ```
4. **예상 결과**:
   - ✅ 승인 안내 메시지 표시 (평일 1-2일)
   - ✅ 파일 업로드 검증 및 오류 처리

### 시나리오 3: 오류 시나리오 테스트

#### 3.1 폼 유효성 검사
1. 각 입력 필드에 잘못된 값 입력:
   - 빈 값
   - 형식에 맞지 않는 값 (이메일, 전화번호 등)
   - 너무 짧거나 긴 값
2. **예상 결과**:
   - ✅ 실시간 필드 검증
   - ✅ InlineMessage로 친화적 오류 표시
   - ✅ 다국어 오류 메시지 (한국어)

#### 3.2 네트워크 오류 시뮬레이션
1. 백엔드 서버 중단 후 API 호출
2. **예상 결과**:
   - ✅ 네트워크 오류 토스트 메시지
   - ✅ 재시도 버튼 제공
   - ✅ 사용자 친화적 오류 안내

### 시나리오 4: 사용자 경험 테스트

#### 4.1 반응형 디자인
1. 모바일, 태블릿, 데스크톱 해상도에서 테스트
2. **예상 결과**:
   - ✅ 모든 해상도에서 UI 정상 동작
   - ✅ 터치 친화적 인터페이스 (모바일)

#### 4.2 접근성
1. 키보드 네비게이션 테스트
2. 스크린 리더 호환성
3. **예상 결과**:
   - ✅ Tab 키로 모든 요소 접근 가능
   - ✅ ARIA 라벨 적절히 설정

## 테스트 체크리스트

### ✅ 완료된 개선사항
- [x] 주문 생성 API 매핑 문제 수정 (items → orderItems)
- [x] OrderController 예외 처리 개선
- [x] 프론트엔드 주문 생성 폼 검증 강화
- [x] 이메일 인증 플로우 실제 테스트
- [x] 데이터베이스 제약조건 및 무결성 확인
- [x] UI/UX 오류 메시지 표시 개선:
  - InlineMessage 컴포넌트 추가
  - useErrorHandler 컴포저블 개선
  - 비즈니스 룰 경고 메시지 구현
  - Toast 알림 시스템 강화

### 🔄 진행 중인 테스트
- [ ] 전체 시스템 E2E 테스트 및 검증

## 주요 개선된 기능

### 1. 오류 처리 시스템
- **InlineMessage 컴포넌트**: 페이지 내 오류 메시지 표시
- **개선된 Toast 시스템**: 네트워크 오류, 비즈니스 룰 경고
- **useErrorHandler**: 통합된 오류 처리 로직

### 2. 비즈니스 룰 검증
- **CBM 임계값 체크**: 29m³ 초과 시 항공운송 전환 경고
- **THB 임계값 체크**: 1,500 THB 초과 시 수취인 정보 추가 안내
- **회원코드 체크**: No code 시 지연 안내

### 3. 사용자 경험 향상
- **실시간 폼 검증**: 입력 즉시 유효성 검사
- **친화적 오류 메시지**: 한국어 지원, 해결방법 제시
- **접근성 개선**: 키보드 네비게이션, ARIA 라벨

## 테스트 결과 기록

### 성공 케이스
- [ ] 일반 사용자 회원가입 → 로그인 → 주문 생성
- [ ] 기업 사용자 회원가입 (승인 대기)
- [ ] CBM/THB 임계값 초과 시 경고 표시
- [ ] 네트워크 오류 시 적절한 안내

### 발견된 이슈
- [ ] API 인증 관련 403 오류 (Spring Security 설정 검토 필요)
- [ ] 기본 관리자 계정 설정 확인 필요

### 개선 제안
- [ ] API 인증 문제 해결
- [ ] 관리자 계정 초기 설정 스크립트 추가
- [ ] E2E 자동화 테스트 환경 구축

## 결론

UI/UX 오류 메시지 표시 개선 작업이 성공적으로 완료되었습니다. 사용자들은 이제 더 친화적이고 구체적인 오류 메시지를 받을 수 있으며, 비즈니스 룰 위반 시에도 적절한 안내를 받을 수 있습니다.

향후 API 인증 문제 해결과 자동화된 E2E 테스트 환경 구축을 통해 시스템의 안정성을 더욱 높일 수 있을 것입니다.